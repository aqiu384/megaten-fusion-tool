"use strict";(self.webpackChunkmegaten_fusion_tool=self.webpackChunkmegaten_fusion_tool||[]).push([[159],{8664:(w,E,o)=>{o.d(E,{G:()=>e});var a=o(5619);class e{constructor(m,d,v,f,C){this.settingsKey=f,this.settingsVersion=C,this._compendium=m,this._compendium$=new a.X(this._compendium),this.compendium=this._compendium$.asObservable(),this._fusionChart=d,this._fusionChart$=new a.X(this._fusionChart),this.fusionChart=this._fusionChart$.asObservable(),this._fusionSettings=v,this._fusionSettings$=new a.X(this._fusionSettings),this.fusionSettings=this._fusionSettings$.asObservable();const c=JSON.parse(localStorage.getItem(this.settingsKey));c&&c.version&&c.version>=this.settingsVersion&&this.updateFusionSettings(c.settings),window.addEventListener("storage",this.onStorageUpdated.bind(this))}updateToggledSettings(m){this._fusionSettings.updateSaveFile(m),this._compendium.updateFusionSettings(this._fusionSettings.demonToggles),this._compendium$.next(this._compendium),this._fusionSettings$.next(this._fusionSettings)}onStorageUpdated(m){m.key===this.settingsKey&&this.updateToggledSettings(JSON.parse(m.newValue).settings)}updateFusionSettings(m){this.updateToggledSettings(m),localStorage.setItem(this.settingsKey,JSON.stringify({version:this.settingsVersion,settings:this._fusionSettings.saveFile}))}}},5939:(w,E,o)=>{o.d(E,{RL:()=>f,gQ:()=>C});var a=o(7548),e=o(6404),r=o(4769),m=o(6814);function d(c,S){if(1&c&&(r.TgZ(0,"tr")(1,"th"),r._uU(2),r.qZA()()),2&c){const u=S.$implicit;r.xp6(2),r.Oqu(u)}}let v=(()=>{class c{ngOnChanges(){if(this.compendium&&this.pairChart&&(this.trioChart||!this.trioCalculator)){const u=[];for(const g of this.compendium.allDemons.filter(l=>!l.isEnemy)){const l=this.compendium.getSpecialNameEntries(g.name);if(l.length>0){u.push(`${g.name} = ${l.join(" x ")}`);continue}const h=this.pairCalculator.getFusions(g.name,this.compendium,this.pairChart).map(y=>(0,e.S6)(y,this.compendium));if(h.length>0&&(h.filter(y=>y.race1!==g.race).length>0||!this.trioCalculator||0===this.trioCalculator.getFusions(g.name,this.compendium,this.trioChart).length)){h.sort((D,A)=>D.price-A.price);const y=h.slice(0,3).map(D=>`${D.name1} x ${D.name2}`).join(", ");u.push(`${g.name} = ${y}`+(h.length>3?`, ${h.length-3} more...`:""))}else{if(this.trioCalculator){const y=this.trioCalculator.getFusions(g.name,this.compendium,this.trioChart).map(D=>(0,e.Aw)(D,this.compendium)).filter(D=>D.d1.race!==g.race);if(y.length>0){y.sort((A,x)=>A.price-x.price);const D=y.slice(0,3).map(A=>`${A.d1.name} x ${A.d2.name} x ${A.d3.name}`).join(", ");u.push(`${g.name} = ${D}`+(y.length>3?`, ${y.length-3} more...`:""));continue}}u.push(g.prereq?`${g.name} = ${g.prereq}`:`${g.name} = No fusions found!`)}}this.fissionPreviews=u}}static#e=this.\u0275fac=function(g){return new(g||c)};static#t=this.\u0275cmp=r.Xpm({type:c,selectors:[["app-fission-preview-table"]],inputs:{pairCalculator:"pairCalculator",trioCalculator:"trioCalculator",pairChart:"pairChart",trioChart:"trioChart",compendium:"compendium"},features:[r.TTD],decls:6,vars:1,consts:[[1,"entry-table"],[1,"title"],[4,"ngFor","ngForOf"]],template:function(g,l){1&g&&(r.TgZ(0,"table",0)(1,"tbody")(2,"tr")(3,"th",1),r._uU(4,"Fission Previews"),r.qZA()(),r.YNc(5,d,3,1,"tr",2),r.qZA()()),2&g&&(r.xp6(5),r.Q6J("ngForOf",l.fissionPreviews))},dependencies:[m.sg],encapsulation:2,changeDetection:0})}return c})(),f=(()=>{class c{constructor(u){this.fusionDataService=u,this.subscriptions=[]}ngOnInit(){this.calculator=this.fusionDataService.fissionCalculator,this.subscriptions.push(this.fusionDataService.compendium.subscribe(u=>{this.compendium=u})),this.subscriptions.push(this.fusionDataService.fusionChart.subscribe(u=>{this.fusionChart=u}))}ngOnDestroy(){for(const u of this.subscriptions)u.unsubscribe()}static#e=this.\u0275fac=function(g){return new(g||c)(r.Y36(a.vE))};static#t=this.\u0275cmp=r.Xpm({type:c,selectors:[["app-smt-fission-preview"]],decls:2,vars:3,consts:[[3,"pairCalculator","pairChart","compendium"]],template:function(g,l){1&g&&(r.TgZ(0,"app-fission-preview-table",0),r._UZ(1,"app-fission-preview-table"),r.qZA()),2&g&&r.Q6J("pairCalculator",l.calculator)("pairChart",l.fusionChart)("compendium",l.compendium)},dependencies:[v],encapsulation:2,changeDetection:0})}return c})(),C=(()=>{class c{constructor(u){this.fusionTrioService=u,this.subscriptions=[]}ngOnInit(){this.pairCalculator=this.fusionTrioService.fissionCalculator,this.trioCalculator=this.fusionTrioService.triFissionCalculator,this.subscriptions.push(this.fusionTrioService.compendium.subscribe(u=>{this.compendium=u})),this.subscriptions.push(this.fusionTrioService.squareChart.subscribe(u=>{this.fusionChart=u}))}ngOnDestroy(){for(const u of this.subscriptions)u.unsubscribe()}static#e=this.\u0275fac=function(g){return new(g||c)(r.Y36(a.Ir))};static#t=this.\u0275cmp=r.Xpm({type:c,selectors:[["app-trio-fission-preview"]],decls:2,vars:5,consts:[[3,"pairCalculator","trioCalculator","pairChart","trioChart","compendium"]],template:function(g,l){1&g&&(r.TgZ(0,"app-fission-preview-table",0),r._UZ(1,"app-fission-preview-table"),r.qZA()),2&g&&r.Q6J("pairCalculator",l.pairCalculator)("trioCalculator",l.trioCalculator)("pairChart",l.fusionChart.normalChart)("trioChart",l.fusionChart)("compendium",l.compendium)},dependencies:[v],encapsulation:2,changeDetection:0})}return c})()},9822:(w,E,o)=>{o.d(E,{j:()=>v});var a=o(4769),e=o(6593),r=o(6814);function m(f,C){if(1&f){const c=a.EpF();a.TgZ(0,"tr")(1,"td")(2,"label"),a._uU(3),a.TgZ(4,"input",3),a.NdJ("change",function(){const g=a.CHM(c).$implicit,l=a.oxw(2);return a.KtG(l.toggledName.emit(g.name))}),a.qZA()()()()}if(2&f){const c=C.$implicit;a.xp6(3),a.hij("",c.caption," "),a.xp6(1),a.Q6J("checked",c.enabled)}}function d(f,C){if(1&f&&(a.ynx(0),a.TgZ(1,"tr")(2,"th"),a._uU(3),a.qZA()(),a.YNc(4,m,5,2,"tr",2),a.BQk()),2&f){const c=C.$implicit;a.xp6(3),a.Oqu(c.category),a.xp6(1),a.Q6J("ngForOf",c.settings)}}let v=(()=>{class f{constructor(c){this.title=c,this.dlcTitle="Included DLC Demons",this.langEn=!0,this.toggledName=new a.vpe}set appTitle(c){this.title.setTitle((this.langEn?"Fusion Settings - ":"\u5408\u4f53\u8a2d\u5b9a ")+c)}static#e=this.\u0275fac=function(S){return new(S||f)(a.Y36(e.Dx))};static#t=this.\u0275cmp=a.Xpm({type:f,selectors:[["app-fusion-settings"]],inputs:{dlcDemons:"dlcDemons",dlcTitle:"dlcTitle",langEn:"langEn",fusionSettings:"fusionSettings",appTitle:"appTitle"},outputs:{toggledName:"toggledName"},decls:10,vars:2,consts:[[1,"entry-table"],[1,"title"],[4,"ngFor","ngForOf"],["type","checkbox",3,"checked","change"]],template:function(S,u){1&S&&(a.ynx(0),a.TgZ(1,"h2"),a._uU(2),a.qZA(),a.TgZ(3,"table",0)(4,"thead")(5,"tr")(6,"th",1),a._uU(7,"Unlock Conditions"),a.qZA()()(),a.TgZ(8,"tbody"),a.YNc(9,d,5,2,"ng-container",2),a.qZA()(),a.BQk()),2&S&&(a.xp6(2),a.Oqu(u.dlcTitle),a.xp6(7),a.Q6J("ngForOf",u.fusionSettings.displayHeaders))},dependencies:[r.sg],encapsulation:2,changeDetection:0})}return f})()},9052:(w,E,o)=>{o.d(E,{m:()=>m});var a=o(7548),e=o(4769),r=o(8615);let m=(()=>{class d{constructor(f,C){this.changeDetectorRef=f,this.fusionTrioService=C,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.fusionTrioService.squareChart.subscribe(f=>{this.normChart=f.normalChart,this.tripChart=f.tripleChart}))}ngOnDestroy(){for(const f of this.subscriptions)f.unsubscribe()}static#e=this.\u0275fac=function(C){return new(C||d)(e.Y36(e.sBO),e.Y36(a.Ir))};static#t=this.\u0275cmp=e.Xpm({type:d,selectors:[["app-triple-fusion-chart"]],decls:1,vars:4,consts:[[3,"normChart","tripChart","normTitle","tripTitle"]],template:function(C,c){1&C&&e._UZ(0,"app-fusion-chart",0),2&C&&e.Q6J("normChart",c.normChart)("tripChart",c.tripChart)("normTitle","Normal Fusions")("tripTitle","Triple Fusions")},dependencies:[r.R],encapsulation:2,changeDetection:0})}return d})()},103:(w,E,o)=>{o.d(E,{s:()=>e});var a=o(4769);let e=(()=>{class r{constructor(d,v){this.changeDetector2=d,this.fusionDataService2=v,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.fusionDataService2.compendium.subscribe(d=>{this.changeDetector2.markForCheck(),this.compendium=d})),this.subscriptions.push(this.fusionDataService2.fusionSettings.subscribe(d=>{this.fusionSettings=d}))}ngOnDestroy(){for(const d of this.subscriptions)d.unsubscribe()}toggleName(d){const v={};v[d]=!this.fusionSettings.isEnabled(d),this.fusionDataService2.updateFusionSettings(v)}static#e=this.\u0275fac=function(v){a.$Z()};static#t=this.\u0275dir=a.lG2({type:r})}return r})()},9778:(w,E,o)=>{o.d(E,{V:()=>a});class a{constructor(r,m,d=","){this.separator=d,this._displayHeaders=[],this._demonToggles={},this._subappToggles={};for(const{category:f,unlocked:C,conditions:c}of r){const S=[];this._displayHeaders.push({category:f,settings:S});for(const u of Object.keys(c))this._demonToggles[u]=C,S.push({name:u,caption:u.split(d).join(", "),enabled:C})}const v=[];m.length>0&&this._displayHeaders.push({category:"Subapps",settings:v});for(const f of m)this._subappToggles[f]=!1,v.push({name:f,caption:f,enabled:!1})}get displayHeaders(){for(const r of this._displayHeaders)for(const m of r.settings)m.enabled=this.saveFile[m.name];return this._displayHeaders}get subappToggles(){return this._subappToggles}get demonToggles(){const r={};for(const[m,d]of Object.entries(this._demonToggles))for(const v of m.split(this.separator))r[v]=d;return r}get saveFile(){return Object.assign({},this._demonToggles,this._subappToggles)}isEnabled(r){return this._demonToggles[r]||this._subappToggles[r]||!1}updateSaveFile(r){for(const m of[this._demonToggles,this._subappToggles])for(const[d,v]of Object.entries(r))m[d]===!v&&(m[d]=v)}}},2812:(w,E,o)=>{o.d(E,{t:()=>e});var a=o(6262);class e extends a.g{constructor(m,d,v){super(),this.elementDemons=[],this.lvlModifier=.5,this.initCharts(m,v)}initCharts(m,d){const v=m.races,f=m.table,C=[];for(let c=0;c<v.length;c++)C.push(f[c].slice(d?0:c,d?c+1:v.length)),d||(C[c][0]="-");this.races=v,this.lvlModifier=d?4.25:.5,this.fissionChart=a.g.loadFissionTableJson(v,this.elementDemons,C),this.fusionChart=a.g.loadFusionTableJson(v,C),this.elementChart={}}}},5020:(w,E,o)=>{o.d(E,{V:()=>qe});var a=o(4487),e=o(4769),r=o(2026),m=o(6814),d=o(5390);let v=(()=>{class s{constructor(t){this.appCssClasses=t.compConfig.appCssClasses;const n=t.compConfig;this.otherLinks=[n.hasQrcodes?{title:"QR Code Generator",link:"qrcodes"}:{title:"Recipe Generator",link:"recipes"}],n.hasEnemies&&this.otherLinks.unshift({title:"Shadow List",link:"shadows"})}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(r.Y))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-pq2-compendium"]],decls:1,vars:3,consts:[[3,"ngClass","mainList","otherLinks"]],template:function(n,i){1&n&&e._UZ(0,"app-demon-compendium",0),2&n&&e.Q6J("ngClass",i.appCssClasses)("mainList","persona")("otherLinks",i.otherLinks)},dependencies:[m.mk,d.e],styles:[".pq2 div.element-icon{height:25px;background-size:25px;background-repeat:no-repeat;background-position:center;color:transparent}.pq2 div.element-icon.i2079,.pq2 div.element-icon.phy{background-image:url(/assets/images/p5/phys.png)}.pq2 div.element-icon.fir{background-image:url(/assets/images/p5/fire.png)}.pq2 div.element-icon.ice{background-image:url(/assets/images/p5/ice.png)}.pq2 div.element-icon.ele{background-image:url(/assets/images/p5/elec.png)}.pq2 div.element-icon.win{background-image:url(/assets/images/p5/wind.png)}.pq2 div.element-icon.psy{background-image:url(/assets/images/p5/psy.png)}.pq2 div.element-icon.nuk{background-image:url(/assets/images/p5/nuke.png)}.pq2 div.element-icon.ble{background-image:url(/assets/images/p5/bless.png)}.pq2 div.element-icon.cur{background-image:url(/assets/images/p5/curse.png)}.pq2 div.element-icon.mag{background-image:url(/assets/images/p5/almighty.png)}.pq2 div.element-icon.ail{background-image:url(/assets/images/p5/ailment.png)}.pq2 div.element-icon.rec{background-image:url(/assets/images/p5/healing.png)}.pq2 div.element-icon.i4095,.pq2 div.element-icon.alm{background-image:url(/assets/images/p5/almighty.png)}.pq2 div.element-icon.def{background-image:url(/assets/images/p5/support.png)}.pq2 div.element-icon.i4088,.pq2 div.element-icon.sup{background-image:url(/assets/images/p5/support.png)}.pq2 div.element-icon.i2047,.pq2 div.element-icon.nav{background-image:url(/assets/images/p5/trait.png)}.pq2 div.element-icon.pas{background-image:url(/assets/images/p5/passive.png)}.pq2 th.title,.pq2 th.nav.active,.pq2 th.nav.active a{color:#fff;background-color:#ff4800}.pq div.element-icon{height:25px;background-size:25px;background-repeat:no-repeat;background-position:center;color:transparent}.pq div.element-icon.cut{background-image:url(/assets/images/p5/sword.png)}.pq div.element-icon.i3584,.pq div.element-icon.i3591,.pq div.element-icon.bas{background-image:url(/assets/images/p5/phys.png)}.pq div.element-icon.sta{background-image:url(/assets/images/p5/gun.png)}.pq div.element-icon.i376,.pq div.element-icon.i383,.pq div.element-icon.i3960,.pq div.element-icon.i3967,.pq div.element-icon.fir{background-image:url(/assets/images/p5/fire.png)}.pq div.element-icon.i248,.pq div.element-icon.i255,.pq div.element-icon.i3832,.pq div.element-icon.i3839,.pq div.element-icon.ice{background-image:url(/assets/images/p5/ice.png)}.pq div.element-icon.i472,.pq div.element-icon.i479,.pq div.element-icon.i4056,.pq div.element-icon.i4063,.pq div.element-icon.ele{background-image:url(/assets/images/p5/elec.png)}.pq div.element-icon.i440,.pq div.element-icon.i447,.pq div.element-icon.i4024,.pq div.element-icon.i4031,.pq div.element-icon.win{background-image:url(/assets/images/p5/wind.png)}.pq div.element-icon.i496,.pq div.element-icon.i503,.pq div.element-icon.i4080,.pq div.element-icon.i4087,.pq div.element-icon.lig{background-image:url(/assets/images/p5/bless.png)}.pq div.element-icon.i488,.pq div.element-icon.i495,.pq div.element-icon.i4072,.pq div.element-icon.i4079,.pq div.element-icon.dar{background-image:url(/assets/images/p5/curse.png)}.pq div.element-icon.ail{background-image:url(/assets/images/p5/ailment.png)}.pq div.element-icon.rec{background-image:url(/assets/images/p5/healing.png)}.pq div.element-icon.i504,.pq div.element-icon.i511,.pq div.element-icon.i4088,.pq div.element-icon.i4095,.pq div.element-icon.alm{background-image:url(/assets/images/p5/almighty.png)}.pq div.element-icon.sup{background-image:url(/assets/images/p5/support.png)}.pq div.element-icon.nav{background-image:url(/assets/images/p5/trait.png)}.pq div.element-icon.pas{background-image:url(/assets/images/p5/passive.png)}.pq th.title,.pq th.nav.active,.pq th.nav.active a{color:#000;background-color:#aa1ca9}.p5t div.element-icon{height:25px;background-size:25px;background-repeat:no-repeat;background-position:center;color:transparent}.p5t div.element-icon.phy{background-image:url(/assets/images/p5/phys.png)}.p5t div.element-icon.gun{background-image:url(/assets/images/p5/gun.png)}.p5t div.element-icon.fir{background-image:url(/assets/images/p5/fire.png)}.p5t div.element-icon.ice{background-image:url(/assets/images/p5/ice.png)}.p5t div.element-icon.ele{background-image:url(/assets/images/p5/elec.png)}.p5t div.element-icon.win{background-image:url(/assets/images/p5/wind.png)}.p5t div.element-icon.psy{background-image:url(/assets/images/p5/psy.png)}.p5t div.element-icon.nuk{background-image:url(/assets/images/p5/nuke.png)}.p5t div.element-icon.ble{background-image:url(/assets/images/p5/bless.png)}.p5t div.element-icon.cur{background-image:url(/assets/images/p5/curse.png)}.p5t div.element-icon.i1023,.p5t div.element-icon.alm{background-image:url(/assets/images/p5/almighty.png)}.p5t div.element-icon.rec{background-image:url(/assets/images/p5/healing.png)}.p5t div.element-icon.sup{background-image:url(/assets/images/p5/support.png)}.p5t div.element-icon.pas{background-image:url(/assets/images/p5/passive.png)}.p5t th.title,.p5t th.nav.active,.p5t th.nav.active a{color:#fff;background-color:#f41000}.p3r th.title,.p3r th.nav.active,.p3r th.nav.active a{color:#000;background-color:#4372aa}.p3r div.element-icon{height:25px;background-size:25px;background-repeat:no-repeat;background-position:center;color:transparent}.p3r div.element-icon.i3583,.p3r div.element-icon.i3585,.p3r div.element-icon.sla{background-image:url(/assets/images/p5/sword.png)}.p3r div.element-icon.i2047,.p3r div.element-icon.i3615,.p3r div.element-icon.str{background-image:url(/assets/images/p5/phys.png)}.p3r div.element-icon.i3071,.p3r div.element-icon.i4065,.p3r div.element-icon.pie{background-image:url(/assets/images/p5/gun.png)}.p3r div.element-icon.i3967,.p3r div.element-icon.i3843,.p3r div.element-icon.i3955,.p3r div.element-icon.i3949,.p3r div.element-icon.fir{background-image:url(/assets/images/p5/fire.png)}.p3r div.element-icon.i3839,.p3r div.element-icon.i3715,.p3r div.element-icon.i3827,.p3r div.element-icon.i3821,.p3r div.element-icon.ice{background-image:url(/assets/images/p5/ice.png)}.p3r div.element-icon.i4063,.p3r div.element-icon.i3651,.p3r div.element-icon.i4051,.p3r div.element-icon.i4045,.p3r div.element-icon.ele{background-image:url(/assets/images/p5/elec.png)}.p3r div.element-icon.i4031,.p3r div.element-icon.i3619,.p3r div.element-icon.i4019,.p3r div.element-icon.i4013,.p3r div.element-icon.win{background-image:url(/assets/images/p5/wind.png)}.p3r div.element-icon.i4083,.p3r div.element-icon.i3603,.p3r div.element-icon.lig{background-image:url(/assets/images/p5/bless.png)}.p3r div.element-icon.i4077,.p3r div.element-icon.i3597,.p3r div.element-icon.dar{background-image:url(/assets/images/p5/curse.png)}.p3r div.element-icon.i493,.p3r div.element-icon.ail{background-image:url(/assets/images/p5/ailment.png)}.p3r div.element-icon.i499,.p3r div.element-icon.rec{background-image:url(/assets/images/p5/healing.png)}.p3r div.element-icon.i4095,.p3r div.element-icon.alm{background-image:url(/assets/images/p5/almighty.png)}.p3r div.element-icon.i511,.p3r div.element-icon.i4088,.p3r div.element-icon.spe{background-image:url(/assets/images/p5/trait.png)}.p3r div.element-icon.sup{background-image:url(/assets/images/p5/support.png)}.p3r div.element-icon.pas{background-image:url(/assets/images/p5/passive.png)}\n"],encapsulation:2,changeDetection:0})}return s})();var f=o(1032),C=o(6593),c=o(4101);let S=(()=>{class s extends f.l{constructor(t,n,i,b){super(t,i,b),this.showAllies=!n.snapshot.data.showShadows,this.showEnemies=!this.showAllies,this.compConfig=b.compConfig,this.defaultSortFun=(k,J)=>200*(this.compConfig.raceOrder[k.race]-this.compConfig.raceOrder[J.race])+J.lvl-k.lvl,this.appName=`List of Personas - ${b.appName}`,this.statHeaders=this.compConfig.baseStats,this.resistHeaders=this.compConfig.hasDemonResists?this.compConfig.resistElems:[],this.inheritOrder=this.compConfig.elemOrder,this.showEnemies&&(this.appName=`List of Shadows - ${b.appName}`,this.statHeaders=this.compConfig.enemyStats,this.resistHeaders=this.compConfig.resistElems,this.inheritOrder=null)}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(C.Dx),e.Y36(a.gz),e.Y36(e.sBO),e.Y36(r.Y))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-demon-list-container"]],features:[e.qOj],decls:2,vars:8,consts:[[3,"isEnemy","raceOrder","statHeaders","resistHeaders","inheritOrder","rowData"]],template:function(n,i){1&n&&(e._UZ(0,"app-smt-demon-list",0),e.ALo(1,"async")),2&n&&e.Q6J("isEnemy",i.showEnemies)("raceOrder",i.compConfig.raceOrder)("statHeaders",i.statHeaders)("resistHeaders",i.resistHeaders)("inheritOrder",i.inheritOrder)("rowData",e.lcZ(1,6,i.demons))},dependencies:[c.Q,m.Ov],encapsulation:2,changeDetection:0})}return s})();var u=o(4330),g=o(3934);let l=(()=>{class s extends u.e{constructor(t,n,i){super(t,n,i),this.appName=`List of Skills - ${i.appName}`,this.compConfig=i.compConfig,this.defaultSortFun=(b,k)=>1e4*(this.compConfig.elemOrder[b.element]-this.compConfig.elemOrder[k.element])+b.rank-k.rank}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(C.Dx),e.Y36(e.sBO),e.Y36(r.Y))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-skill-list-container"]],features:[e.qOj],decls:2,vars:8,consts:[[3,"elemOrder","hasRank","hasTarget","isPersona","transferTitle","rowData"]],template:function(n,i){1&n&&(e._UZ(0,"app-smt-skill-list",0),e.ALo(1,"async")),2&n&&e.Q6J("elemOrder",i.compConfig.elemOrder)("hasRank",!1)("hasTarget",!0)("isPersona",!0)("transferTitle","Skill Card")("rowData",e.lcZ(1,6,i.skills))},dependencies:[g.J,m.Ov],encapsulation:2,changeDetection:0})}return s})();var h=o(7880),Z=o(8520),y=o(1009),D=o(755),A=o(9012),x=o(4069),O=o(8711);let q=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-enemy-entry"]],inputs:{name:"name",demon:"demon",compendium:"compendium",compConfig:"compConfig"},decls:19,vars:14,consts:[[3,"title","statHeaders","stats"],[1,"entry-table"],["colspan","2",1,"title"],[3,"resistHeaders","resists","ailmentHeaders","ailments"],[3,"hasTarget","hasLvl","elemOrder","compendium","skillLevels"]],template:function(n,i){1&n&&(e._UZ(0,"app-demon-stats",0),e.TgZ(1,"table",1)(2,"thead")(3,"tr")(4,"th",2),e._uU(5,"Appearances"),e.qZA()(),e.TgZ(6,"tr")(7,"th"),e._uU(8,"Areas"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Drops"),e.qZA()()(),e.TgZ(11,"tbody")(12,"tr")(13,"td"),e._uU(14),e.qZA(),e.TgZ(15,"td"),e._uU(16),e.qZA()()()(),e._UZ(17,"app-demon-resists",3)(18,"app-demon-skills",4)),2&n&&(e.Q6J("title","Lvl "+i.demon.lvl+" "+i.demon.race+" "+i.demon.name)("statHeaders",i.compConfig.enemyStats)("stats",i.demon.stats),e.xp6(14),e.Oqu(i.demon.area),e.xp6(2),e.Oqu(i.demon.drop),e.xp6(1),e.Q6J("resistHeaders",i.compConfig.resistElems)("resists",i.demon.resists)("ailmentHeaders",i.compConfig.ailmentElems)("ailments",i.demon.ailments),e.xp6(1),e.Q6J("hasTarget",!0)("hasLvl",!1)("elemOrder",i.compConfig.elemOrder)("compendium",i.compendium)("skillLevels",i.demon.skills))},dependencies:[Z.O,y.I,D.n],encapsulation:2,changeDetection:0})}return s})();function F(s,_){if(1&s&&e._UZ(0,"app-demon-resists",7),2&s){const t=e.oxw(2);e.Q6J("resistHeaders",t.compConfig.resistElems)("resists",t.demon.resists)}}function Q(s,_){if(1&s&&(e.ynx(0),e._UZ(1,"app-demon-stats",2),e.YNc(2,F,1,2,"app-demon-resists",3),e._UZ(3,"app-demon-inherits",4)(4,"app-demon-skills",5)(5,"app-smt-fusions",6),e.BQk()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("title","Lvl "+t.demon.lvl+" "+t.demon.race+" "+t.demon.name)("price",t.demon.price)("statHeaders",t.compConfig.baseStats)("stats",t.demon.stats)("inherits",t.demon.inherits),e.xp6(1),e.Q6J("ngIf",t.compConfig.hasDemonResists),e.xp6(1),e.Q6J("inheritHeaders",t.compConfig.inheritElems)("inherits",t.compendium.getInheritElems(t.demon.inherits)),e.xp6(1),e.Q6J("hasTarget",!0)("elemOrder",t.compConfig.elemOrder)("compendium",t.compendium)("skillLevels",t.demon.skills),e.xp6(1),e.Q6J("hasTripleFusion",t.compConfig.hasTripleFusion)("excludedDlc","excluded"===t.demon.fusion)}}function T(s,_){if(1&s&&e._UZ(0,"app-demon-missing",8),2&s){const t=e.oxw();e.Q6J("name",t.name)}}function p(s,_){if(1&s&&e._UZ(0,"app-demon-entry",1),2&s){const t=e.oxw();e.Q6J("name",t.name)("demon",t.demon)("compConfig",t.compConfig)("compendium",t.compendium)}}function N(s,_){if(1&s&&e._UZ(0,"app-enemy-entry",1),2&s){const t=e.oxw();e.Q6J("name",t.name)("demon",t.demon)("compConfig",t.compConfig)("compendium",t.compendium)}}let I=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-demon-entry"]],inputs:{name:"name",demon:"demon",compendium:"compendium",compConfig:"compConfig"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"name",4,"ngIf"],[3,"title","price","statHeaders","stats","inherits"],[3,"resistHeaders","resists",4,"ngIf"],[3,"inheritHeaders","inherits"],[3,"hasTarget","elemOrder","compendium","skillLevels"],[3,"hasTripleFusion","excludedDlc"],[3,"resistHeaders","resists"],[3,"name"]],template:function(n,i){1&n&&(e.YNc(0,Q,6,14,"ng-container",0),e.YNc(1,T,1,1,"app-demon-missing",1)),2&n&&(e.Q6J("ngIf",i.demon),e.xp6(1),e.Q6J("ngIf",!i.demon))},dependencies:[m.O5,h.t,Z.O,y.I,D.n,A.N,x.O],encapsulation:2,changeDetection:0})}return s})(),R=(()=>{class s{constructor(t,n,i,b){this.route=t,this.title=n,this.currentDemonService=i,this.fusionDataService=b,this.subscriptions=[],this.appName="Test App",this.appName=b.appName,this.compConfig=b.compConfig}ngOnInit(){this.subscribeAll()}ngOnDestroy(){for(const t of this.subscriptions)t.unsubscribe()}subscribeAll(){this.subscriptions.push(this.fusionDataService.compendium.subscribe(t=>{this.compendium=t,this.getDemonEntry()})),this.subscriptions.push(this.currentDemonService.currentDemon.subscribe(t=>{this.name=t,this.getDemonEntry()})),this.route.params.subscribe(t=>{this.currentDemonService.nextCurrentDemon(t.demonName)})}getDemonEntry(){this.compendium&&this.name&&(this.title.setTitle(`${this.name} - ${this.appName}`),this.demon=this.compendium.getDemon(this.name))}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(a.gz),e.Y36(C.Dx),e.Y36(O.s),e.Y36(r.Y))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-demon-entry-container"]],decls:2,vars:2,consts:[[3,"name","demon","compConfig","compendium",4,"ngIf"],[3,"name","demon","compConfig","compendium"]],template:function(n,i){1&n&&(e.YNc(0,p,1,4,"app-demon-entry",0),e.YNc(1,N,1,4,"app-enemy-entry",0)),2&n&&(e.Q6J("ngIf",!i.demon||!i.demon.isEnemy),e.xp6(1),e.Q6J("ngIf",i.demon&&i.demon.isEnemy))},dependencies:[m.O5,I,q],encapsulation:2,changeDetection:0})}return s})();const P=Array(24).fill(0);function M(s,_){return s.split("").map(t=>t.charCodeAt(0)).concat(Array(_-s.length).fill(0))}P[0]=4,P[2]=50,P[4]=50,P[6]=50,P[7]=50,P[8]=50,P[12]=50,P[16]=50,P[20]=50;const $=[].concat(M("aqiu384.github.io",21),M("https://youtu.be/b1KfNEPKncQ",33)),Y="kitaro",B="bancho",H=[].concat(M(Y,17),M(B,17)),K=[].concat(M(Y,29),M(B,29)),X=[].concat(M(Y,17),M(B,17),M("renren",17),M("hamuko",17)),W=[].concat([34,50],Array(36).fill(31),[31,0,31,0,0,0,1,128]),V=[].concat([34,50],Array(54).fill(31),[31,0,1,0]);var U=o(95);let se=(()=>{class s{constructor(){this.byteArray=[],this.errorLvl="L",this.typeNum=10,this.qrFactory=qrcode(this.typeNum,this.errorLvl),this.qrImg=null}ngOnChanges(){this.createQrcode()}createQrcode(){this.qrFactory=qrcode(this.typeNum,this.errorLvl),this.qrFactory.addData(this.byteArray.map(t=>String.fromCharCode(t)).join("")),this.qrFactory.make(),this.qrImg=this.qrFactory.createImgTag(5)}static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-qrcode"]],inputs:{byteArray:"byteArray",errorLvl:"errorLvl",typeNum:"typeNum"},features:[e.TTD],decls:1,vars:1,consts:[[3,"innerHtml"]],template:function(n,i){1&n&&e._UZ(0,"div",0),2&n&&e.Q6J("innerHtml",i.qrImg,e.oJD)},encapsulation:2,changeDetection:0})}return s})();var ne=o(2173);function ie(s,_){if(1&s&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&s){const t=_.index;e.Q6J("value",t+1),e.xp6(1),e.Oqu(t+1)}}function oe(s,_){if(1&s&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&s){const t=_.index;e.Q6J("value",t+1),e.xp6(1),e.Oqu(t+1)}}function ae(s,_){if(1&s&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&s){const t=_.index;e.Q6J("value",t+1),e.xp6(1),e.Oqu(t+1)}}function re(s,_){if(1&s&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&s){const t=_.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function le(s,_){if(1&s&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&s){const t=_.$implicit;e.Q6J("value",t.name),e.xp6(1),e.Oqu(t.name)}}function ce(s,_){if(1&s&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&s){const t=_.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t)}}function pe(s,_){if(1&s&&(e.TgZ(0,"option",17),e._uU(1),e.qZA()),2&s){const t=_.$implicit;e.Q6J("value",t.name),e.xp6(1),e.Oqu(t.name)}}function me(s,_){if(1&s&&(e.ynx(0),e.TgZ(1,"td"),e._uU(2),e.ALo(3,"skillCostToString"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.BQk()),2&s){const t=_.$implicit;e.xp6(1),e.Udp("color",t.cost?null:"transparent"),e.xp6(1),e.Oqu(e.lcZ(3,5,t.cost)),e.xp6(3),e.Oqu(t.effect),e.xp6(2),e.Oqu(t.target)}}function ue(s,_){1&s&&(e.TgZ(0,"td"),e._uU(1,"-"),e.qZA(),e.TgZ(2,"td"),e._uU(3,"-"),e.qZA(),e.TgZ(4,"td"),e._uU(5,"-"),e.qZA())}const de=function(s){return{unique:s}};function ge(s,_){if(1&s){const t=e.EpF();e.ynx(0,18),e.TgZ(1,"tr",19)(2,"td")(3,"select",20),e.NdJ("change",function(){const b=e.CHM(t).$implicit,k=e.oxw();return e.KtG(b.controls.name.setValue(k.skills[b.controls.elem.value][0].name))}),e.TgZ(4,"option",21),e._uU(5,"-"),e.qZA(),e.YNc(6,ce,2,2,"option",9),e.qZA()(),e.TgZ(7,"td")(8,"select",22),e.YNc(9,pe,2,2,"option",9),e.qZA()(),e.YNc(10,me,8,7,"ng-container",23),e.YNc(11,ue,6,0,"ng-template",null,24,e.W1O),e.qZA(),e.BQk()}if(2&s){const t=_.$implicit,n=_.index,i=e.MAs(12),b=e.oxw();e.Q6J("formGroupName",n),e.xp6(1),e.Q6J("ngClass",e.VKq(6,de,(b.compendium.getSkill(t.controls.name.value)||b.blankSkill).rank>90)),e.xp6(5),e.Q6J("ngForOf",b.elems),e.xp6(3),e.Q6J("ngForOf",b.skills[t.controls.elem.value]),e.xp6(1),e.Q6J("ngIf",b.compendium.getSkill(t.controls.name.value))("ngIfElse",i)}}let he=(()=>{class s{constructor(t){this.fb=t,this.defaultRace="Fool",this.defaultDemon="Slime",this.demons={},this.skills={},this.dcodes={},this.scodes={},this.range99=Array(99),this.range299=Array(299),this.price=0,this.blankSkill={code:0,cost:0,level:0,rank:0,target:"Self",name:"-",element:"-",inherit:"-",effect:"-",learnedBy:[],transfer:[]},this.createForm()}ngOnChanges(){this.initDropdowns()}createForm(){const t=[];for(let n=0;n<6;n++)t.push(this.fb.group({elem:"-",name:"-"}));this.form=this.fb.group({language:"eng",lvl:1,hp:1,mp:1,race:this.defaultRace,demon:this.defaultDemon,skills:this.fb.array(t)}),this.form.valueChanges.subscribe(n=>{if(this.form.valid){const i=this.compendium.getDemon(n.demon),b=n.skills.map(L=>this.compendium.getSkill(L.name)||this.blankSkill),k={language:n.language,demonCode:i.code,lvl:parseInt(n.lvl,10),exp:-1,hp:parseInt(n.hp,10),mp:parseInt(n.mp,10),skillCodes:b.map(L=>L.code)},J=k.skillCodes.reduce((L,Ae)=>0!==Ae?L+1:L,0);this.price=10*Math.floor((800+120*k.lvl)*(1+.25*J)/10),this.passBytes=function z(s,_){return _&&_.includes("2")?function te(s){const _=P.slice(),t=Array(25).fill(0),n=s.lvl,i=Math.floor((((-.0479755766*n+9.28700353)*n+71.9694228)*n-81.1026214)*n+.120783542),b=s.exp<0?i:s.exp;"jpn"!==s.language&&(_[6]=256-_[6]),t[0]=s.demonCode%256,t[1]=2*s.lvl+Math.floor(s.demonCode/256),t[2]=b%256,t[3]=Math.floor(b/256)%256,t[4]=Math.floor(b/65536);for(let k=0;k<6;k++)t[6+2*k]=s.skillCodes[k]%256,t[6+2*k+1]=Math.floor(s.skillCodes[k]/256);return t[22]=10*s.hp%256,t[23]=10*s.mp%16*16+Math.floor(s.hp/25.6),t[24]=Math.floor(s.mp/1.6),[].concat(_,$,X,V,t,Array(21).fill(0))}(s):function ee(s){const _="jpn"===s.language?H:K,t=Array(30).fill(0),n=s.lvl,i=Math.floor((((-.07600161*n+14.0603287)*n-.02256972)*n+.59031556)*n-1.87981906),b=s.exp<0?i:s.exp;t[0]=s.demonCode,t[2]=s.lvl,t[6]=b%256,t[7]=Math.floor(b/256)%256,t[8]=Math.floor(b/65536);for(let k=0;k<6;k++)t[10+2*k]=s.skillCodes[k]%256,t[10+2*k+1]=Math.floor(s.skillCodes[k]/256);return t[26]=10*s.hp%256,t[27]=Math.floor(s.hp/25.6),t[28]=10*s.mp%256,t[29]=Math.floor(s.mp/25.6),[].concat(P,$,_,W,t,Array(40).fill(0))}(s)}(k,this.compConfig.appTitle)}})}initDropdowns(){if(this.demons={},this.skills={"-":[this.blankSkill]},this.dcodes={},this.scodes={0:this.blankSkill},this.compConfig&&this.compendium){for(const t of this.compendium.allDemons.filter(n=>n.code))this.demons[t.race]||(this.demons[t.race]=[]),this.demons[t.race].push(t),this.dcodes[t.code]=t;for(const t of this.compendium.allSkills.filter(n=>n.code))this.skills[t.element]||(this.skills[t.element]=[]),this.skills[t.element].push(t),this.scodes[t.code]=t;for(const t of Object.values(this.demons))t.sort((n,i)=>i.lvl-n.lvl);for(const t of Object.values(this.skills))t.sort((n,i)=>n.rank-i.rank);this.races=this.compConfig.races.filter(t=>this.demons[t]),this.elems=this.compConfig.skillElems.filter(t=>this.skills[t]),this.setDefaultValues(this.defaultDemon)}}changeRace(t){const n=this.demons[t][0];this.form.controls.demon.setValue(n.name),this.setDefaultValues(n.name)}setDefaultValues(t){const n=Array(6).fill(this.blankSkill),i=this.compendium.getDemon(t);let b=0;for(const[k,J]of Object.entries(i.skills))0===J&&(n[b++]=this.compendium.getSkill(k));this.form.patchValue({lvl:Math.floor(i.lvl),hp:i.stats[0],mp:i.stats[1],race:i.race,demon:i.name,skills:n.map(k=>({elem:k.element,name:k.name}))})}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(U.qu))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-password-generator"]],inputs:{defaultRace:"defaultRace",defaultDemon:"defaultDemon",compendium:"compendium",compConfig:"compConfig"},features:[e.TTD],decls:69,vars:9,consts:[[3,"formGroup"],[1,"entry-table"],["colspan","2",1,"title"],[3,"byteArray"],["colspan","7",1,"title"],["formControlName","language"],["value","jpn"],["value","eng"],["formControlName","lvl"],[3,"value",4,"ngFor","ngForOf"],["formControlName","hp"],["formControlName","mp"],["formControlName","race",3,"change"],["formControlName","demon",3,"change"],["formArrayName","skills",1,"list-table"],["colspan","5",1,"title"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"value"],[3,"formGroupName"],[3,"ngClass"],["formControlName","elem",3,"change"],["value","-"],["formControlName","name"],[4,"ngIf","ngIfElse"],["noEntry",""]],template:function(n,i){1&n&&(e.TgZ(0,"form",0)(1,"h2"),e._uU(2,"QR Code Generator"),e.qZA(),e.TgZ(3,"table",1)(4,"tr")(5,"th",2),e._uU(6,"QR Code"),e.qZA()(),e.TgZ(7,"tr")(8,"td"),e._UZ(9,"app-qrcode",3),e.qZA()()(),e.TgZ(10,"table",1)(11,"tr")(12,"th",4),e._uU(13,"Persona Entry"),e.qZA()(),e.TgZ(14,"tr")(15,"th"),e._uU(16,"Price"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Language"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Level"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"HP"),e.qZA(),e.TgZ(23,"th"),e._uU(24,"MP"),e.qZA(),e.TgZ(25,"th"),e._uU(26,"Race"),e.qZA(),e.TgZ(27,"th"),e._uU(28,"Demon"),e.qZA()(),e.TgZ(29,"tr")(30,"td"),e._uU(31),e.qZA(),e.TgZ(32,"td")(33,"select",5)(34,"option",6),e._uU(35,"Japanese"),e.qZA(),e.TgZ(36,"option",7),e._uU(37,"English"),e.qZA()()(),e.TgZ(38,"td")(39,"select",8),e.YNc(40,ie,2,2,"option",9),e.qZA()(),e.TgZ(41,"td")(42,"select",10),e.YNc(43,oe,2,2,"option",9),e.qZA()(),e.TgZ(44,"td")(45,"select",11),e.YNc(46,ae,2,2,"option",9),e.qZA()(),e.TgZ(47,"td")(48,"select",12),e.NdJ("change",function(){return i.changeRace(i.form.controls.race.value)}),e.YNc(49,re,2,2,"option",9),e.qZA()(),e.TgZ(50,"td")(51,"select",13),e.NdJ("change",function(){return i.setDefaultValues(i.form.controls.demon.value)}),e.YNc(52,le,2,2,"option",9),e.qZA()()()(),e.TgZ(53,"table",14)(54,"tr")(55,"th",15),e._uU(56,"Learned Skills"),e.qZA()(),e.TgZ(57,"tr")(58,"th"),e._uU(59,"Element"),e.qZA(),e.TgZ(60,"th"),e._uU(61,"Name"),e.qZA(),e.TgZ(62,"th"),e._uU(63,"Cost"),e.qZA(),e.TgZ(64,"th"),e._uU(65,"Effect"),e.qZA(),e.TgZ(66,"th"),e._uU(67,"Target"),e.qZA()(),e.YNc(68,ge,13,8,"ng-container",16),e.qZA()()),2&n&&(e.Q6J("formGroup",i.form),e.xp6(9),e.Q6J("byteArray",i.passBytes),e.xp6(22),e.Oqu(i.price),e.xp6(9),e.Q6J("ngForOf",i.range99),e.xp6(3),e.Q6J("ngForOf",i.range299),e.xp6(3),e.Q6J("ngForOf",i.range99),e.xp6(3),e.Q6J("ngForOf",i.races),e.xp6(3),e.Q6J("ngForOf",i.demons[i.form.controls.race.value]),e.xp6(16),e.Q6J("ngForOf",i.form.controls.skills.controls))},dependencies:[m.mk,m.sg,m.O5,U._Y,U.YN,U.Kr,U.EJ,U.JJ,U.JL,U.sg,U.u,U.x0,U.CE,se,ne.tq],styles:["td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%}input[_ngcontent-%COMP%]{width:95%;border-width:3px}input.ng-valid[_ngcontent-%COMP%]{border-color:#0f0}input.ng-invalid[_ngcontent-%COMP%]{border-color:red}"],changeDetection:0})}return s})(),fe=(()=>{class s{constructor(t,n){this.fusionDataService=t,this.title=n,this.subscriptions=[],this.compConfig=this.fusionDataService.compConfig}ngOnInit(){this.setTitle(),this.subscribeAll()}ngOnDestroy(){this.unsubscribeAll()}setTitle(){this.title.setTitle(`QR Code Generator - ${this.fusionDataService.appName}`)}subscribeAll(){this.subscriptions.push(this.fusionDataService.compendium.subscribe(t=>{this.compendium=t}))}unsubscribeAll(){for(const t of this.subscriptions)t.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(r.Y),e.Y36(C.Dx))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-password-generator-container"]],decls:1,vars:2,consts:[[3,"compendium","compConfig"]],template:function(n,i){1&n&&e._UZ(0,"app-password-generator",0),2&n&&e.Q6J("compendium",i.compendium)("compConfig",i.compConfig)},dependencies:[he],encapsulation:2,changeDetection:0})}return s})();var ve=o(103),Ce=o(9822);let _e=(()=>{class s extends ve.s{constructor(t,n){super(t,n),this.changeDetector=t,this.fusionDataService=n,this.appTitle=n.appName}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(e.sBO),e.Y36(r.Y))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-fusion-settings-container"]],features:[e.qOj],decls:1,vars:3,consts:[[3,"appTitle","dlcTitle","fusionSettings","toggledName"]],template:function(n,i){1&n&&(e.TgZ(0,"app-fusion-settings",0),e.NdJ("toggledName",function(k){return i.toggleName(k)}),e.qZA()),2&n&&e.Q6J("appTitle",i.appTitle)("dlcTitle","Fusion Settings")("fusionSettings",i.fusionSettings)},dependencies:[Ce.j],encapsulation:2,changeDetection:0})}return s})();var be=o(4436);let Te=(()=>{class s{constructor(t,n){this.fusionDataService=t,this.title=n,this.subscriptions=[];const i=this.fusionDataService.compConfig;this.maxSkills=i.hasDemonResists?8:2,this.recipeConfig={fissionCalculator:this.fusionDataService.fissionCalculator,fusionCalculator:this.fusionDataService.fusionCalculator,races:i.races,skillElems:i.skillElems,inheritElems:i.inheritElems,restrictInherits:!0,triExclusiveRaces:i.hasTripleFusion?["Fool","Tower","Moon","Sun","Judgement"]:[],triFissionCalculator:this.fusionDataService.triFissionCalculator,triFusionCalculator:this.fusionDataService.triFusionCalculator,defaultDemon:"Pixie"}}ngOnInit(){this.setTitle(),this.subscribeAll()}ngOnDestroy(){this.unsubscribeAll()}setTitle(){this.title.setTitle(`Recipe Generator - ${this.fusionDataService.appName}`)}subscribeAll(){this.subscriptions.push(this.fusionDataService.compendium.subscribe(t=>{this.compendium=t})),this.subscriptions.push(this.fusionDataService.squareChart.subscribe(t=>{this.squareChart=t}))}unsubscribeAll(){for(const t of this.subscriptions)t.unsubscribe()}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(r.Y),e.Y36(C.Dx))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-recipe-generator-container"]],decls:1,vars:4,consts:[[3,"maxSkills","compendium","squareChart","recipeConfig"]],template:function(n,i){1&n&&e._UZ(0,"app-recipe-generator",0),2&n&&e.Q6J("maxSkills",i.maxSkills)("compendium",i.compendium)("squareChart",i.squareChart)("recipeConfig",i.recipeConfig)},dependencies:[be.X],encapsulation:2,changeDetection:0})}return s})();var ye=o(5939),ke=o(5657),De=o(4689),Oe=o(6857),Ee=o(4170);const Ze=[{path:"",redirectTo:"personas",pathMatch:"full"},{path:"",component:v,data:{fusionTool:"chart"},children:[{path:"chart",component:o(9052).m}]},{path:"",component:v,children:[{path:"personas/:demonName",component:R,children:[{path:"fissions/triple",component:Oe.p},{path:"fusions/triple",component:Ee.n},{path:"fissions",component:ke.t},{path:"fusions",component:De.$},{path:"**",redirectTo:"fissions",pathMatch:"full"}]},{path:"shadows/:demonName",component:R},{path:"personas",component:S},{path:"shadows",component:S,data:{showShadows:!0}},{path:"skills",component:l},{path:"qrcodes",component:fe},{path:"recipes",component:Te},{path:"settings",component:_e},{path:"previews",component:ye.RL}]},{path:"**",redirectTo:"personas",pathMatch:"full"}];let qe=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[a.Bz.forChild(Ze),a.Bz]})}return s})()},2026:(w,E,o)=>{o.d(E,{Y:()=>u});var a=o(5619);class e{constructor(l,h){this.compConfig=l,this.specialRecipes={},this.initImportedData(),this.updateDerivedData(h)}initImportedData(){const l={},h={},Z={},y={},D={},A={};for(const[T,p]of Object.entries(this.compConfig.resistCodes))A[T]=((p/1e4|0)<<10)+(p%1e4/2.5|0);const x="-".repeat(this.compConfig.resistElems.length),O="-".repeat(this.compConfig.ailmentElems.length),q=T=>(T||x).split("").map(p=>A[p]),F=T=>(T||O).split("").map(p=>A[p]),Q=this.compConfig.hasDemonResists;for(const[T,p]of Object.entries(this.compConfig.demonData)){const N=Object.values(p.skills).reduce((R,P)=>0===P?R+1:R,0),I=10*Math.floor((800+120*p.lvl)*(1+.25*N)/10);l[T]={name:T,race:p.race,lvl:p.lvl,currLvl:p.lvl,price:p.price||I,inherits:this.compConfig.inheritTypes[p.inherit||p.inherits],stats:p.stats,skills:p.skills,resists:Q?q(p.resists):[],ailments:Q?F(p.ailments):[],code:p.code||0,fusion:p.fusion||"normal",prereq:p.prereq||""}}for(const[T,p]of Object.entries(this.compConfig.enemyData))h[T]={name:T,race:p.race,lvl:p.lvl,currLvl:p.lvl,price:0,inherits:0,stats:p.stats,resists:q(p.resists),ailments:F(p.ailments),skills:p.skills.reduce((N,I)=>(N[I]=0,N),{}),area:p.area,drop:p.drops?.join(", ")||"-",code:0,fusion:"normal",isEnemy:!0};for(const[T,p]of Object.entries(this.compConfig.specialRecipes))y[T]=p,l[T].fusion="special";for(const[T,p]of Object.entries(this.compConfig.skillData))Z[T]={name:T,element:p.elem||p.element,cost:p.cost||0,rank:p.unique?91:(1023&p.cost)/100||1,effect:p.effect,target:p.target||"Self",learnedBy:[],transfer:[],code:p.code||0,level:0},p.card&&(Z[T].transfer=p.card.split(", ").map(N=>({demon:N,level:-100})));for(const T of this.compConfig.races)D[T]={};for(const T of Object.values(l).sort((p,N)=>p.lvl-N.lvl)){"party"!==T.fusion&&(D[T.race][T.lvl]=T.name);for(const[p,N]of Object.entries(T.skills))Z[p].learnedBy.push({demon:T.name,level:N})}this.demons=l,this.enemies=h,this.skills=Z,this.specialRecipes=y,this.invertedDemons=D}updateDerivedData(l){const h=Object.assign({},this.demons),Z=[],y={},D={};for(const O of Object.values(this.skills))O.learnedBy.length<1&&O.transfer.length<1?O.rank=99:Z.push(O);for(const O of this.compConfig.races)y[O]=[],D[O]=[];for(const[O,q]of Object.entries(this.demons))"party"!==q.fusion&&(y[q.race].push(q.lvl),this.specialRecipes.hasOwnProperty(O)||D[q.race].push(q.lvl));for(const O of this.compConfig.races)y[O].sort((q,F)=>q-F),D[O].sort((q,F)=>q-F);for(const[O,q]of Object.entries(l))if(!q){const{race:F,lvl:Q}=this.demons[O];delete h[O],y[F]=y[F].filter(T=>T!==Q),D[F]=D[F].filter(T=>T!==Q)}const A=Object.keys(h).map(O=>h[O]),x=Object.keys(this.enemies).map(O=>this.enemies[O]);this._allDemons=x.concat(A),this._allSkills=Z,this.allIngredients=y,this.allResults=D}get allDemons(){return this._allDemons}get allSkills(){return this._allSkills}get specialDemons(){return Object.keys(this.specialRecipes).map(l=>this.demons[l])}getDemon(l){return this.demons[l]||this.enemies[l]}getSkill(l){return this.skills[l]}getSkills(l){const h=this.compConfig.elemOrder,Z=l.map(y=>this.skills[y]);return Z.sort((y,D)=>1e4*(h[y.element]-h[D.element])+y.rank-D.rank),Z}getIngredientDemonLvls(l){return this.allIngredients[l]||[]}getResultDemonLvls(l){return this.allResults[l]||[]}getSpecialNameEntries(l){return this.specialRecipes[l]||[]}getSpecialNamePairs(l){return[]}getInheritElems(l){return l.toString(2).padStart(this.compConfig.inheritElems.length,"0").split("").map(h=>100*parseInt(h))}reverseLookupDemon(l,h){return this.invertedDemons[l][h]}reverseLookupSpecial(l){return[]}isElementDemon(l){return!1}updateFusionSettings(l){this.updateDerivedData(l)}}var r=o(2812),m=o(7548),d=o(3837),v=o(1139),f=o(7862),C=o(8664),c=o(9778),S=o(4769);let u=(()=>{class g extends C.G{constructor(h){const Z=new r.t(h.normalTable,h.races),y=new c.V(h.demonUnlocks,[]);super(new e(h,y.demonToggles),Z,y,h.settingsKey,h.settingsVersion),this.fissionCalculator=m.Bz,this.fusionCalculator=m.wC,this.triFissionCalculator=m.nL,this.triFusionCalculator=m.RD,this.compConfig=h,this.appName=h.appTitle+" Fusion Calculator",this._tripleChart=new r.t(h.normalTable,h.races,!0),this._squareChart$=new a.X({normalChart:Z,tripleChart:this._tripleChart,raceOrder:h.raceOrder}),this.squareChart=this._squareChart$.asObservable(),h.appCssClasses.includes("p5t")&&(this.fissionCalculator=new d.N([f.Mg],[]),this.fusionCalculator=new d.N([v.ne],[]))}static#e=this.\u0275fac=function(Z){return new(Z||g)(S.LFG(m.I7))};static#t=this.\u0275prov=S.Yz7({token:g,factory:g.\u0275fac})}return g})()},159:(w,E,o)=>{o.d(E,{G:()=>f});var a=o(95),e=o(6814),r=o(6208),m=o(8325),d=o(5020),v=o(4769);let f=(()=>{class C{static forRoot(){return{ngModule:C}}static#e=this.\u0275fac=function(u){return new(u||C)};static#t=this.\u0275mod=v.oAB({type:C});static#s=this.\u0275inj=v.cJS({imports:[e.ez,r.m,a.UX,m.a,d.V]})}return C})()}}]);