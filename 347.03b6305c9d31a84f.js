"use strict";(self.webpackChunkmegaten_fusion_tool=self.webpackChunkmegaten_fusion_tool||[]).push([[347],{609:(Z,K,u)=>{u.d(K,{d:()=>n});var l=u(4412);class n{constructor(a,D,I,N,L){this.settingsKey=N,this.settingsVersion=L,this._compendium=a,this._compendium$=new l.t(this._compendium),this.compendium=this._compendium$.asObservable(),this._fusionChart=D,this._fusionChart$=new l.t(this._fusionChart),this.fusionChart=this._fusionChart$.asObservable(),this._fusionSettings=I,this._fusionSettings$=new l.t(this._fusionSettings),this.fusionSettings=this._fusionSettings$.asObservable();const U=JSON.parse(localStorage.getItem(this.settingsKey));U&&U.version&&U.version>=this.settingsVersion&&this.updateFusionSettings(U.settings),window.addEventListener("storage",this.onStorageUpdated.bind(this))}updateToggledSettings(a){this._fusionSettings.updateSaveFile(a),this._compendium.updateFusionSettings(this._fusionSettings.demonToggles),this._compendium$.next(this._compendium),this._fusionSettings$.next(this._fusionSettings)}onStorageUpdated(a){a.key===this.settingsKey&&this.updateToggledSettings(JSON.parse(a.newValue).settings)}updateFusionSettings(a){this.updateToggledSettings(a),localStorage.setItem(this.settingsKey,JSON.stringify({version:this.settingsVersion,settings:this._fusionSettings.saveFile}))}}},9436:(Z,K,u)=>{u.d(K,{d:()=>R});var l=u(1090),n=u(2598),i=u(177),a=u(4207);function D(c,T){if(1&c&&(n.j41(0,"th",4),n.EFF(1,"Inheritable Skills"),n.k0s()),2&c){const d=n.XpG();n.BMQ("colspan",d.inheritHeaders.length)}}function I(c,T){if(1&c&&(n.j41(0,"th",4),n.EFF(1),n.nI1(2,"translateComp"),n.k0s()),2&c){const d=n.XpG();n.BMQ("colspan",d.inheritHeaders.length),n.R7$(1),n.SpI(" ",n.i5U(2,2,d.msgs.SkillAffinities,d.lang)," ")}}function N(c,T){if(1&c&&(n.qex(0),n.EFF(1),n.bVm()),2&c){const d=n.XpG().$implicit;n.R7$(1),n.JRh(d)}}function L(c,T){if(1&c&&(n.j41(0,"div"),n.EFF(1),n.k0s()),2&c){const d=n.XpG().$implicit;n.ZvI("element-icon ",d,""),n.R7$(1),n.JRh(d)}}function U(c,T){if(1&c&&(n.j41(0,"th"),n.DNE(1,N,2,1,"ng-container",3),n.DNE(2,L,2,4,"div",5),n.k0s()),2&c){const d=n.XpG();n.xc7("width",100/d.inheritHeaders.length,"%"),n.R7$(1),n.Y8G("ngIf",!d.hasIcons),n.R7$(1),n.Y8G("ngIf",d.hasIcons)}}function W(c,T){if(1&c&&(n.j41(0,"td"),n.EFF(1),n.k0s()),2&c){const d=T.$implicit;n.xc7("color",d?null:"transparent"),n.R7$(1),n.SpI(" ",d?"yes":"no"," ")}}function t(c,T){if(1&c&&(n.j41(0,"tr"),n.DNE(1,W,2,3,"td",6),n.k0s()),2&c){const d=n.XpG();n.R7$(1),n.Y8G("ngForOf",d.inherits)}}function S(c,T){if(1&c&&(n.j41(0,"td"),n.nI1(1,"roundInheritPercent"),n.EFF(2),n.k0s()),2&c){const d=T.$implicit;n.ZvI("affinity",n.bMT(1,4,d),""),n.R7$(2),n.SpI(" ",d,"% ")}}function k(c,T){if(1&c&&(n.j41(0,"tr"),n.DNE(1,S,3,6,"td",7),n.k0s()),2&c){const d=n.XpG();n.R7$(1),n.Y8G("ngForOf",d.inherits)}}function p(c,T){if(1&c&&(n.j41(0,"td"),n.EFF(1),n.nI1(2,"affinityToString"),n.k0s()),2&c){const d=T.$implicit;n.ZvI("affinity",d,""),n.R7$(1),n.SpI(" ",n.bMT(2,4,d)," ")}}function _(c,T){if(1&c&&(n.j41(0,"tr"),n.DNE(1,p,3,6,"td",7),n.k0s()),2&c){const d=n.XpG();n.R7$(1),n.Y8G("ngForOf",d.inherits)}}let R=(()=>{class c{constructor(){this.inheritHeaders=[],this.inherits=[],this.hasChance=!1,this.hasIcons=!0,this.hasLvls=!1,this.lang="en",this.msgs=l.dx}static{this.\u0275fac=function(Y){return new(Y||c)}}static{this.\u0275cmp=n.VBU({type:c,selectors:[["app-demon-inherits"]],inputs:{inheritHeaders:"inheritHeaders",inherits:"inherits",hasChance:"hasChance",hasIcons:"hasIcons",hasLvls:"hasLvls",lang:"lang"},decls:11,vars:6,consts:[[1,"entry-table"],["class","title",4,"ngIf"],[3,"width",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"title"],[3,"class",4,"ngIf"],[3,"color",4,"ngFor","ngForOf"],[3,"class",4,"ngFor","ngForOf"]],template:function(Y,w){1&Y&&(n.j41(0,"table",0)(1,"thead")(2,"tr"),n.DNE(3,D,2,1,"th",1),n.DNE(4,I,3,5,"th",1),n.k0s(),n.j41(5,"tr"),n.DNE(6,U,3,4,"th",2),n.k0s()(),n.j41(7,"tbody"),n.DNE(8,t,2,1,"tr",3),n.DNE(9,k,2,1,"tr",3),n.DNE(10,_,2,1,"tr",3),n.k0s()()),2&Y&&(n.R7$(3),n.Y8G("ngIf",!w.hasLvls),n.R7$(1),n.Y8G("ngIf",w.hasLvls&&w.inheritHeaders.length),n.R7$(2),n.Y8G("ngForOf",w.inheritHeaders),n.R7$(2),n.Y8G("ngIf",!w.hasLvls&&!w.hasChance),n.R7$(1),n.Y8G("ngIf",w.hasChance),n.R7$(1),n.Y8G("ngIf",w.hasLvls))},dependencies:[i.Sq,i.bT,a.uz,a.XM,a.D8],encapsulation:2,changeDetection:0})}}return c})()},9023:(Z,K,u)=>{u.d(K,{q:()=>S});var l=u(2755),n=u(1090),i=u(2598),a=u(345),D=u(8935),I=u(177);function N(k,p){if(1&k&&(i.j41(0,"th"),i.EFF(1),i.k0s()),2&k){const _=p.$implicit,R=i.XpG();i.R7$(1),i.JRh(_.slice(0,R.nameCut))}}function L(k,p){if(1&k&&(i.j41(0,"td",4),i.EFF(1),i.k0s()),2&k){const _=p.$implicit,R=i.XpG(2);i.Y8G("ngClass",_.slice(0,4)),i.R7$(1),i.JRh(_.slice(4,R.nameCut+4))}}function U(k,p){if(1&k&&(i.j41(0,"tr")(1,"th"),i.EFF(2),i.k0s(),i.DNE(3,L,2,2,"td",3),i.j41(4,"th"),i.EFF(5),i.k0s()()),2&k){const _=p.$implicit;i.R7$(2),i.JRh(_[0]),i.R7$(1),i.Y8G("ngForOf",_.slice(1,_.length-1)),i.R7$(2),i.JRh(_[_.length-1])}}function W(k,p){if(1&k&&(i.j41(0,"th"),i.EFF(1),i.k0s()),2&k){const _=p.$implicit,R=i.XpG();i.R7$(1),i.JRh(_.slice(0,R.nameCut))}}function t(k,p){if(1&k&&(i.j41(0,"tr")(1,"th",0),i.EFF(2),i.k0s()()),2&k){const _=i.XpG();i.R7$(1),i.BMQ("colspan",_.table[0].length),i.R7$(1),i.Lme("",_.appName," ",_.tripTitle,"")}}class S{static{this.RESULT_COLORS=Object.entries({oran:["-2","Erthys","Gnome","Saki Mitama","Random","\u30a2\u30fc\u30b7\u30fc\u30ba","\u30ce\u30fc\u30e0","\u30b5\u30ad\u30df\u30bf\u30de"],redd:["-1","Flaemis","Salamander","Ara Mitama","Fiend","\u30d5\u30ec\u30a4\u30df\u30fc\u30ba","\u30b5\u30e9\u30de\u30f3\u30c0\u30fc","\u30a2\u30e9\u30df\u30bf\u30de"],gree:["1","Aeros","Sylph","Kushi Mitama","Kusi Mitama","UMA","\u30a8\u30a2\u30ed\u30b9","\u30b7\u30eb\u30ad\u30fc","\u30af\u30b7\u30df\u30bf\u30de"],blue:["2","Aquans","Undine","Nigi Mitama","Enigma","\u30a2\u30af\u30a2\u30f3\u30ba","\u30a6\u30f3\u30c7\u30a3\u30fc\u30cd","\u30cb\u30ae\u30df\u30bf\u30de"]})}constructor(p,_){this.title2=p,this.route=_,this.normTitle="Normal Fusions",this.tripTitle="",this.isPersona=!1,this.filterDarks=!0,this.lang="en",this.msgs=n.qh,this.subscriptions=[],this.table=[],this.nameCut=4}ngOnInit(){this.subscriptions.push(this.route.parent.data.subscribe(p=>{this.appName=p.appName||"Shin Megami Tensei",this.nameCut=parseInt((0,l.o)(this.msgs.NameCut,p.lang)),this.title2.setTitle((0,l.o)(this.msgs.AppTitle,p.lang).replace("$APP",this.appName))}))}ngOnChanges(){this.normChart&&this.fillFusionChart()}ngOnDestroy(){for(const p of this.subscriptions)p.unsubscribe()}fillFusionChart(){const p="noneNone",R=S.RESULT_COLORS.reduce((v,[M,X])=>X.reduce((J,tt)=>(J[tt]=M,J),v),{}),c=this.normChart.elementDemons;let T=[],d=this.normChart.races,Y=[];this.filterDarks&&(T=this.normChart.races.filter(v=>this.normChart.getLightDark(v)>0),d=this.normChart.races.filter(v=>0===this.normChart.getLightDark(v)),Y=this.normChart.races.filter(v=>-1===this.normChart.getLightDark(v)),0===Y.length&&T.length>0&&(T=this.normChart.races.filter(v=>this.normChart.getLightDark(v)>-1),d=[],Y=this.normChart.races.filter(v=>this.normChart.getLightDark(v)<-1)));const w=T.length-Y.length,z=T.concat(d,c),it=Y.length?Y.concat(Array(z.length-Y.length).fill("")):z,pt=this.mitaTable?z:T.concat(d,Array(c.length).fill("")),ot=this.mitaTable||Y.length?Array(w).fill("").concat(Y,d,c):z;this.table=[[""].concat(z,[""])];for(let v=0;v<ot.length;v++){const M=Array(z.length+2).fill("empt-"),X=ot[v],J=pt[v],tt=-1!==c.indexOf(X),ut=-1!==c.indexOf(J);this.table.push(M),M[0]=X,M[M.length-1]=J;for(let P=v;P<z.length;P++){const x=z[P],V=-1!==c.indexOf(x);if(V&&ut){const H=c.indexOf(J),r=c.indexOf(x),m=this.mitaTable[r][H].replace("-","");M[P+1]=m?(R[m]||"norm")+m:p}else if(V&&J){const H=this.normChart.getElemFusions(x)[J];M[P+1]=H?(R[H]||"rank")+(H>0?"+":"")+H.toString():p}else if(x&&J){const H=this.isPersona&&x===J?x:this.normChart.getRaceFusion(x,J);M[P+1]=H?(R[H]||(x===J?"elem":"norm"))+H:p}}if(this.tripChart)for(let P=0;P<=v-w;P++){const x=it[P];if(x&&tt){const V=this.tripChart.getElemFusions(X)[x];M[P+1]=V?(R[V]||"rank")+(V>0?"+":"")+V.toString():p}else if(x&&X){const V=this.tripChart.getRaceFusion(x,X);M[P+1]=V?(R[V]||(x===X?"elem":"trip"))+V:p}}if(-1!==X.indexOf(" x ")){const[P,x]=X.split(" x "),V=P.slice(0,3)+"x"+x.slice(0,3);M[0]=V,M[M.length-1]=V}else if(-1!==X.indexOf(" ")){const P=X.split(" ")[0];M[0]=P,M[M.length-1]=P}}for(let v=0;v<this.table[0].length;v++){const M=this.table[0][v];if(-1!==M.indexOf(" x ")){const[X,J]=M.split(" x ");this.table[0][v]=X.slice(0,2)+J.slice(0,2)}}this.table.push([""].concat(it,[""]))}static{this.\u0275fac=function(_){return new(_||S)(i.rXU(a.hE),i.rXU(D.nX))}}static{this.\u0275cmp=i.VBU({type:S,selectors:[["app-fusion-chart"]],inputs:{normChart:"normChart",tripChart:"tripChart",mitaTable:"mitaTable",normTitle:"normTitle",tripTitle:"tripTitle",isPersona:"isPersona",filterDarks:"filterDarks",lang:"lang",counter:"counter"},features:[i.OA$],decls:12,vars:7,consts:[[1,"title"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(_,R){1&_&&(i.j41(0,"table")(1,"tbody")(2,"tr")(3,"th",0),i.EFF(4),i.k0s()(),i.j41(5,"tr"),i.DNE(6,N,2,1,"th",1),i.k0s(),i.DNE(7,U,6,3,"tr",1),i.j41(8,"tr"),i.DNE(9,W,2,1,"th",1),i.k0s(),i.DNE(10,t,3,3,"tr",2),i.k0s(),i.nrm(11,"tbody"),i.k0s()),2&_&&(i.R7$(3),i.BMQ("colspan",R.table[0].length),i.R7$(1),i.Lme("",R.appName," ",R.normTitle,""),i.R7$(2),i.Y8G("ngForOf",R.table[0]),i.R7$(1),i.Y8G("ngForOf",R.table.slice(1,R.table.length-1)),i.R7$(2),i.Y8G("ngForOf",R.table[R.table.length-1]),i.R7$(1),i.Y8G("ngIf",R.tripTitle))},dependencies:[I.YU,I.Sq,I.bT],styles:["table[_ngcontent-%COMP%]{width:auto;margin:0 auto;white-space:nowrap}td.elem[_ngcontent-%COMP%]{color:#0f0}td.trip[_ngcontent-%COMP%]{color:#d3d3d3}td.oran[_ngcontent-%COMP%]{color:orange}td.redd[_ngcontent-%COMP%]{color:red}td.gree[_ngcontent-%COMP%]{color:#0f0}td.blue[_ngcontent-%COMP%]{color:#0ff}td.none[_ngcontent-%COMP%]{color:transparent}td.empt[_ngcontent-%COMP%]{background-color:transparent;color:transparent}"],changeDetection:0})}}},860:(Z,K,u)=>{u.d(K,{B:()=>W});var l=u(2598),n=u(2755),i=u(1090),a=u(345),D=u(177),I=u(4207);function N(t,S){if(1&t){const k=l.RV6();l.qex(0),l.j41(1,"tr")(2,"th"),l.EFF(3,"All Demons"),l.k0s()(),l.j41(4,"tr")(5,"td")(6,"button",4),l.bIt("click",function(){l.eBV(k);const _=l.XpG();return l.Njj(_.toggledAll.emit(!0))}),l.EFF(7,"Enable All"),l.k0s(),l.j41(8,"button",4),l.bIt("click",function(){l.eBV(k);const _=l.XpG();return l.Njj(_.toggledAll.emit(!1))}),l.EFF(9,"Disable All"),l.k0s()()(),l.bVm()}}function L(t,S){if(1&t){const k=l.RV6();l.j41(0,"tr")(1,"td")(2,"label"),l.EFF(3),l.j41(4,"input",5),l.bIt("change",function(){const R=l.eBV(k).$implicit,c=l.XpG(2);return l.Njj(c.toggledName.emit(R.name))}),l.k0s()()()()}if(2&t){const k=S.$implicit;l.R7$(3),l.SpI("",k.caption," "),l.R7$(1),l.Y8G("checked",k.enabled)}}function U(t,S){if(1&t&&(l.qex(0),l.j41(1,"tr")(2,"th"),l.EFF(3),l.k0s()(),l.DNE(4,L,5,2,"tr",3),l.bVm()),2&t){const k=S.$implicit;l.R7$(3),l.JRh(k.category),l.R7$(1),l.Y8G("ngForOf",k.settings)}}let W=(()=>{class t{constructor(k){this.title=k,this.lang="en",this.showEnableAll=!1,this.toggledAll=new l.bkB,this.toggledName=new l.bkB,this.msgs=i.BR}set appTitle(k){this.title.setTitle((0,n.o)(this.msgs.AppTitle,this.lang)+k)}static{this.\u0275fac=function(p){return new(p||t)(l.rXU(a.hE))}}static{this.\u0275cmp=l.VBU({type:t,selectors:[["app-fusion-settings"]],inputs:{dlcDemons:"dlcDemons",lang:"lang",fusionSettings:"fusionSettings",showEnableAll:"showEnableAll",appTitle:"appTitle"},outputs:{toggledAll:"toggledAll",toggledName:"toggledName"},decls:12,vars:6,consts:[[1,"entry-table"],[1,"title"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","50%",3,"click"],["type","checkbox",3,"checked","change"]],template:function(p,_){1&p&&(l.qex(0),l.j41(1,"h2"),l.EFF(2),l.nI1(3,"translateComp"),l.k0s(),l.j41(4,"table",0)(5,"thead")(6,"tr")(7,"th",1),l.EFF(8,"Unlock Conditions"),l.k0s()()(),l.j41(9,"tbody"),l.DNE(10,N,10,0,"ng-container",2),l.DNE(11,U,5,2,"ng-container",3),l.k0s()(),l.bVm()),2&p&&(l.R7$(2),l.JRh(l.i5U(3,3,_.msgs.DlcTitle,_.lang)),l.R7$(8),l.Y8G("ngIf",_.showEnableAll),l.R7$(1),l.Y8G("ngForOf",_.fusionSettings.displayHeaders))},dependencies:[D.Sq,D.bT,I.uz],encapsulation:2,changeDetection:0})}}return t})()},1289:(Z,K,u)=>{u.d(K,{h:()=>H});var l=u(4207),n=u(4660);function a(r,m){return parseInt(m.map(e=>r.includes(e)?"1":"0").join(""),2)||0}function D(r,m){return r.map((e,s,o)=>a(o.slice(0,s+1),m))}function N(r,m,e,s,o,h){let g=e,f=[g];const O=s.getSpecialNameEntries(g),j=m[m.length-1];if(0!==O.length&&(g=O.find($=>0===s.getSpecialNameEntries($).length),f.unshift(O.filter($=>$!==g).join(" x ")),f.unshift(g)),r.length>0){const $=function U(r,m,e,s,o){const{fusionCalculator:h}=o,g=r.slice(0,1);if(r.length<2)return g;let f=g[0],O=m[0];for(let j=1;j<r.length;j++){const $=r[j],b=m[j],C=h.getFusions(f,e,s).map(G=>(0,n.lA)(G,e)).sort((G,Q)=>G.price-Q.price);let y=!1;for(const G of C)if(G.name1===$&&(b&e.getDemon(G.name2).inherits)===b){g.push($),g.push(G.name2),f=g[g.length-1],O=b,y=!0;break}if(y)continue;const B=h.getFusions($,e,s).reduce((G,Q)=>(G[Q.name1]=Q.name2,G),{});for(const G of C)if(B[G.name2]&&(O&e.getDemon(G.name2).inherits)===O&&(b&e.getDemon(B[G.name2]).inherits)===b){g.push(G.name1),g.push(G.name2),g.push($),g.push(B[G.name2]),f=g[g.length-1],O=b,y=!0;break}if(!y)return[]}return g}(r,m,s,o,h);if(0===$.length)return[];const b=$[$.length-1];let C=L(b,g,j,s,o,h);if(0===C.length){const y=s.getDemon(g),rt=s.getResultDemonLvls(y.race).filter(B=>B<100).map(B=>s.reverseLookupDemon(y.race,B)).filter(B=>B!==g);for(const B of o.elementDemons.concat(rt)){if((j&s.getDemon(B).inherits)!==j)continue;const G=L(b,B,j,s,o,h),Q=L(B,g,j,s,o,h);if(0!==G.length&&0!==Q.length){C=G.concat(Q.slice(1));break}}}if(0===C.length)return[];f=$.concat(C.slice(1),f.slice(1))}return f}function L(r,m,e,s,o,h){const{fissionCalculator:g,fusionCalculator:f}=h,O=[r];if(r===m)return O;const j=f.getFusions(r,s,o).map(C=>(0,n.lA)(C,s)).sort((C,y)=>C.price-y.price);for(const C of j)if(C.name2===m)return O.push(C.name1),O.push(m),O;const $=g.getFusions(m,s,o).map(C=>(0,n.on)(C,s)).sort((C,y)=>C.price-y.price);j.sort((C,y)=>y.price-C.price);const b=j.reduce((C,y)=>(C[y.name2]=y.name1,C),{});for(const C of $){if(b[C.name1]&&(e&s.getDemon(C.name1).inherits)===e)return O.push(b[C.name1]),O.push(C.name1),O.push(C.name2),O.push(m),O;if(b[C.name2]&&(e&s.getDemon(C.name2).inherits)===e)return O.push(b[C.name2]),O.push(C.name2),O.push(C.name1),O.push(m),O}return[]}var W=u(1090),t=u(2598),S=u(4341),k=u(177);function p(r,m){if(1&r&&(t.j41(0,"option",16),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function _(r,m){if(1&r&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.Y8G("ngValue",e),t.R7$(1),t.JRh(e.name)}}function R(r,m){if(1&r&&(t.j41(0,"option",16),t.EFF(1),t.k0s()),2&r){const e=m.$implicit,s=t.XpG(3);t.Y8G("value",e),t.R7$(1),t.JRh(s.recipeConfig.displayElems[e]||e)}}function c(r,m){if(1&r&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.Y8G("ngValue",e),t.R7$(1),t.JRh(e.name)}}function T(r,m){if(1&r&&(t.j41(0,"option",16),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.Y8G("value",e),t.R7$(1),t.JRh(e)}}function d(r,m){if(1&r&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.Y8G("ngValue",e),t.R7$(1),t.JRh(e.name)}}function Y(r,m){if(1&r&&(t.j41(0,"select",25),t.DNE(1,d,2,2,"option",8),t.k0s()),2&r){const e=t.XpG(2).$implicit,s=t.XpG();t.R7$(1),t.Y8G("ngForOf",s.learnedBy[e.controls.skill.value.name])}}function w(r,m){if(1&r&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.Y8G("ngValue",e),t.R7$(1),t.JRh(e.name)}}function z(r,m){if(1&r&&(t.j41(0,"select",25),t.DNE(1,w,2,2,"option",8),t.k0s()),2&r){const e=t.XpG(2).$implicit,s=t.XpG();t.R7$(1),t.Y8G("ngForOf",s.demons[e.controls.race.value])}}function it(r,m){if(1&r){const e=t.RV6();t.j41(0,"tr")(1,"td")(2,"label"),t.EFF(3),t.nI1(4,"translateComp"),t.j41(5,"input",20),t.bIt("change",function(){t.eBV(e);const o=t.XpG().$implicit,h=t.XpG();return t.Njj(h.setIngredDemon(o))}),t.k0s()()(),t.j41(6,"td")(7,"select",21),t.bIt("change",function(){t.eBV(e);const o=t.XpG().$implicit,h=t.XpG();return t.Njj(h.setIngredElem(o))}),t.j41(8,"option",22),t.EFF(9,"-"),t.k0s(),t.DNE(10,R,2,2,"option",6),t.k0s()(),t.j41(11,"td")(12,"select",23),t.bIt("change",function(){t.eBV(e);const o=t.XpG().$implicit,h=t.XpG();return t.Njj(h.setIngredDemon(o))}),t.DNE(13,c,2,2,"option",8),t.k0s()(),t.j41(14,"td")(15,"select",5),t.bIt("change",function(){t.eBV(e);const o=t.XpG().$implicit,h=t.XpG();return t.Njj(h.setIngredDemon(o))}),t.j41(16,"option",22),t.EFF(17,"-"),t.k0s(),t.DNE(18,T,2,2,"option",6),t.k0s()(),t.j41(19,"td"),t.DNE(20,Y,2,1,"select",24),t.DNE(21,z,2,1,"select",24),t.k0s()()}if(2&r){const e=t.XpG(),s=e.index,o=e.$implicit,h=t.XpG();t.R7$(3),t.Lme("",t.i5U(4,10,h.msgs.LearnsSkill,h.lang),"",s+1," "),t.R7$(4),t.BMQ("disabled",!o.controls.searchSkill.value||null),t.R7$(3),t.Y8G("ngForOf",h.elems),t.R7$(2),t.BMQ("disabled",!o.controls.searchSkill.value||null),t.R7$(1),t.Y8G("ngForOf",h.skills[o.controls.elem.value]),t.R7$(2),t.BMQ("disabled",o.controls.searchSkill.value||null),t.R7$(3),t.Y8G("ngForOf",h.races),t.R7$(2),t.Y8G("ngIf",o.controls.searchSkill.value),t.R7$(1),t.Y8G("ngIf",!o.controls.searchSkill.value)}}function pt(r,m){if(1&r&&(t.qex(0,18),t.DNE(1,it,22,13,"tr",19),t.bVm()),2&r){const e=m.index,s=t.XpG();t.Y8G("formGroupName",e),t.R7$(1),t.Y8G("ngIf",e<s.maxSkills)}}function ot(r,m){if(1&r&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.R7$(1),t.JRh(e)}}function v(r,m){if(1&r&&(t.j41(0,"td",29)(1,"ul"),t.DNE(2,ot,2,1,"li",30),t.k0s()()),2&r){const e=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",e.recipeLeft)}}function M(r,m){if(1&r&&(t.j41(0,"td",31),t.EFF(1),t.nI1(2,"translateComp"),t.k0s()),2&r){const e=t.XpG(2);t.R7$(1),t.JRh(t.i5U(2,1,e.msgs.NoRecipesFound,e.lang))}}function X(r,m){if(1&r&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&r){const e=m.$implicit;t.R7$(1),t.JRh(e)}}function J(r,m){if(1&r&&(t.j41(0,"td",29)(1,"ul"),t.DNE(2,X,2,1,"li",30),t.k0s()()),2&r){const e=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",e.recipeRight)}}function tt(r,m){if(1&r&&(t.j41(0,"td",31),t.EFF(1),t.nI1(2,"translateComp"),t.k0s()),2&r){const e=t.XpG(2);t.R7$(1),t.JRh(t.i5U(2,1,e.msgs.NoRecipesFound,e.lang))}}function ut(r,m){if(1&r&&(t.j41(0,"tr")(1,"td",28),t.EFF(2),t.nI1(3,"translateComp"),t.k0s()()),2&r){const e=t.XpG(2);t.R7$(2),t.Lme(" ",t.i5U(3,2,e.msgs.SpecialFusionCondition,e.lang),": ",e.fusionPrereq," ")}}function P(r,m){if(1&r&&(t.qex(0),t.EFF(1),t.nrm(2,"br"),t.EFF(3),t.bVm()),2&r){const e=t.XpG(2);t.R7$(1),t.Lme(" ",e.recipeResult.join(" x ")," = ",e.recipe.result,""),t.R7$(2),t.SpI(" [",e.resultSkills.join(", "),"] ")}}function x(r,m){if(1&r&&(t.qex(0),t.EFF(1),t.nI1(2,"translateComp"),t.bVm()),2&r){const e=t.XpG(2);t.R7$(1),t.JRh(t.i5U(2,1,e.msgs.NoRecipesFound,e.lang))}}function V(r,m){if(1&r&&(t.j41(0,"table",1)(1,"tr")(2,"th",2),t.EFF(3),t.nI1(4,"translateComp"),t.k0s()(),t.j41(5,"tr")(6,"th"),t.EFF(7),t.nI1(8,"translateComp"),t.k0s(),t.j41(9,"th"),t.EFF(10),t.nI1(11,"translateComp"),t.k0s()(),t.j41(12,"tr"),t.DNE(13,v,3,1,"td",26),t.DNE(14,M,3,4,"td",27),t.DNE(15,J,3,1,"td",26),t.DNE(16,tt,3,4,"td",27),t.k0s(),t.DNE(17,ut,4,5,"tr",19),t.j41(18,"tr")(19,"td",28),t.DNE(20,P,4,3,"ng-container",19),t.DNE(21,x,3,4,"ng-container",19),t.k0s()()()),2&r){const e=t.XpG();t.R7$(3),t.JRh(t.i5U(4,10,e.msgs.FusionRecipe,e.lang)),t.R7$(4),t.JRh(t.i5U(8,13,e.msgs.LeftChain,e.lang)),t.R7$(3),t.JRh(t.i5U(11,16,e.msgs.RightChain,e.lang)),t.R7$(3),t.Y8G("ngIf",e.recipeLeft.length),t.R7$(1),t.Y8G("ngIf",!e.recipeLeft.length),t.R7$(1),t.Y8G("ngIf",e.recipeRight.length),t.R7$(1),t.Y8G("ngIf",!e.recipeRight.length),t.R7$(1),t.Y8G("ngIf",e.fusionPrereq),t.R7$(3),t.Y8G("ngIf",e.recipe.stepR.length),t.R7$(1),t.Y8G("ngIf",!e.recipe.stepR.length)}}let H=(()=>{class r{constructor(e){this.fb=e,this.maxSkills=8,this.lang="en",this.internalMaxSkills=9,this.range99=Array(99),this.demons={},this.skills={},this.learnedBy={},this.fusionPrereq="",this.msgs=W.hV,this.skillLevelPipe=new l.wv,this.blankDemon={name:"-",race:"-",lvl:0,currLvl:0,price:0,inherits:0,skills:{},stats:[],resists:[],affinities:[],fusion:"normal",prereq:""},this.blankSkill={name:"-",element:"-",inherit:"-",rank:99,cost:0,effect:"",target:"",level:0,learnedBy:[{demon:"-",level:0}]},this.createForm()}ngOnChanges(){this.initDropdowns()}createForm(){const e=[];for(let s=0;s<this.internalMaxSkills;s++)e.push(this.fb.group({searchSkill:!0,elem:"-",skill:this.blankSkill,race:{value:"-",disabled:!0},demon:this.blankDemon}));this.form=this.fb.group({race:"-",demon:this.blankDemon,ingreds:this.fb.array(e)}),this.form.valueChanges.subscribe(s=>{if(this.form.valid){const o=s.ingreds.filter(g=>"-"!==g.demon.name&&g.demon.name!==s.demon.name).map(g=>g.demon.name),h={};for(const g of s.ingreds)g.searchSkill&&"-"!==g.skill.name&&(h[g.skill.name]=g.demon.name);this.updateRecipe(function i(r,m,e,s,o,h){const{fissionCalculator:g,inheritElems:f,restrictInherits:O,triExclusiveRaces:j,triFissionCalculator:$}=h,{normalChart:b}=o,C=s.getDemon(r),y={};for(const[F,E]of Object.entries(e))"-"!==E&&E!==C.name&&(y[F]=E);const B=a(Object.keys(e).map(F=>s.getSkill(F)).map(F=>F.inherit),f);let G=s.getSpecialNameEntries(r);if(G.length<2&&j.includes(C.race)){const F=$.getFusions(r,s,o).map(E=>(0,n.f7)(E,s)).sort((E,A)=>E.price-A.price).find(E=>(B&(E.d1.inherits|E.d2.inherits))===B&&!j.includes(E.d1.race)&&!j.includes(E.d2.race)&&!j.includes(E.d3.race));F&&(G=[F.d1.name,F.d2.name,F.d3.name])}if(G.length<2){const F=g.getFusions(r,s,b).map(E=>(0,n.on)(E,s)).sort((E,A)=>E.price-A.price).find(E=>(B&(s.getDemon(E.name1).inherits|s.getDemon(E.name2).inherits))===B&&"accident"!==s.getDemon(E.name1).fusion&&"accident"!==s.getDemon(E.name2).fusion&&!j.includes(s.getDemon(E.name1).race)&&!j.includes(s.getDemon(E.name2).race));F&&(G=[F.name1,F.name2])}const Q=G.map(F=>s.getDemon(F)).sort((F,E)=>E.price-F.price),ft=Object.keys(y).map(F=>s.getSkill(F)),lt=a(ft.map(F=>F.inherit),f),kt=ft.map(F=>a([F.inherit],f));let at,_t,dt=0;for(let F=0;F<Q.length;F++){const E=Q[F];for(const A of Q.slice(F+1))if((lt&(E.inherits|A.inherits))===lt){const Rt=(lt&E.inherits).toString(2).split("1").length*(lt&A.inherits).toString(2).split("1").length;dt<Rt&&(at=E,_t=A,dt=Rt)}}const ct={chain1:[],chain2:[],stepR:G,skills:y,result:r};if(!at)return ct;const et=Object.values(y).filter((F,E,A)=>A.indexOf(F)===E),ht=m.filter(F=>!et.includes(F));let q=Math.ceil(et.length/2);et.sort((F,E)=>b.getLightDark(s.getDemon(F).race)-b.getLightDark(s.getDemon(E).race));let nt=et.slice(0,q),mt=Array(nt.length).fill(0),st=et.slice(q),gt=Array(st.length).fill(0);if(O){const{left:F,right:E}=function I(r,m,e,s){let o=[],h=[];const g=[],f=[],O={},j=[];for(let $=0;$<e.length;$++){const b=e[$];0!==b?(O.hasOwnProperty(b)||(O[b]=[]),O[b].push(s[$])):j.push(s[$])}for(const $ of Object.keys(O).sort()){const b=parseInt($);g.length<=f.length?(b&r)===b?g.push(b):f.push(b):(b&m)===b?f.push(b):g.push(b)}for(const $ of g)o=o.concat(O[$]);for(const $ of f)h=h.concat(O[$]);for(const $ of j)o.length<h.length?o.push($):h.push($);return{left:o.reverse(),right:h.reverse()}}(at.inherits,_t.inherits,kt,ft.map(A=>A.name));nt=F.map(A=>y[A]),mt=D(F.map(A=>s.getSkill(A).inherit),f),st=E.map(A=>y[A]),gt=D(E.map(A=>s.getSkill(A).inherit),f)}return q=Math.ceil(ht.length/2),nt=ht.slice(0,q).concat(nt),mt=Array(q).fill(0).concat(mt),st=ht.slice(q).concat(st),gt=Array(ht.length-q).fill(0).concat(gt),ct.chain1=N(nt,mt,at.name,s,b,h),ct.chain2=N(st,gt,_t.name,s,b,h),ct}(s.demon.name,o,h,this.compendium,this.squareChart,this.recipeConfig))}})}setIngredElem(e){e.controls.skill.setValue(this.skills[e.controls.elem.value][0]),this.setIngredDemon(e)}setIngredDemon(e){e.controls.demon.setValue((e.controls.searchSkill.value?this.learnedBy[e.controls.skill.value.name]:this.demons[e.controls.race.value])[0])}updateRecipe(e){const s={};for(const[o,h]of Object.entries(e.skills)){s[h]||(s[h]=[]);const g=this.compendium.getDemon(h).skills[o];s[h].push(`${o} ${this.skillLevelPipe.transform(g)}`.trim())}this.recipe=e,this.recipeLeft=this.decodeRecipechain(e.chain1,s),this.recipeRight=this.decodeRecipechain(e.chain2,s),this.resultSkills=[],this.recipeResult=[],this.fusionPrereq=this.compendium.getDemon(e.result).prereq||"";for(const o of e.stepR)this.recipeResult.push(s[o]?`${o} [${s[o].join(", ")}]`:o);for(const[o,h]of Object.entries(this.compendium.getDemon(e.result).skills).filter(g=>g[1]<2e3).sort((g,f)=>g[1]-f[1]))this.resultSkills.push(`${o} ${this.skillLevelPipe.transform(h)}`.trim())}decodeRecipechain(e,s){const o=[];for(let h=0;h<e.length-2;h+=2){const g=s[e[h]]?"["+s[e[h]].join(", ")+"] ":"",f=s[e[h+1]]?"["+s[e[h+1]].join(", ")+"] ":"";o.push(`${e[h]} ${g}x ${e[h+1]} ${f}= ${e[h+2]}`)}return o}initDropdowns(){if(this.recipeConfig&&this.compendium&&this.squareChart){this.demons={"-":[this.blankDemon]},this.skills={"-":[this.blankSkill]},this.learnedBy={"-":[this.blankDemon]};for(const e of this.compendium.allDemons)if(!e.isEnemy&&"party"!==e.fusion&&"enemy"!==e.fusion){this.demons[e.race]||(this.demons[e.race]=[]),this.demons[e.race].push(e);for(const s of Object.keys(e.skills))this.learnedBy[s]||(this.learnedBy[s]=[]),this.learnedBy[s].push(e)}for(const e of this.compendium.allSkills.filter(s=>s.rank<50&&s.learnedBy.length>0))this.skills[e.inherit]||(this.skills[e.inherit]=[]),this.skills[e.inherit].push(e);for(const e of Object.values(this.demons))e.sort((s,o)=>s.lvl-o.lvl);for(const e of Object.values(this.learnedBy))e.sort((s,o)=>s.lvl-o.lvl);for(const e of Object.values(this.skills))e.sort((s,o)=>s.rank-o.rank);this.races=this.recipeConfig.races.filter(e=>this.demons[e]),this.elems=this.recipeConfig.skillElems.filter(e=>this.skills[e]),this.setDemon(this.compendium.getDemon(this.recipeConfig.defaultDemon))}}setDemon(e){const s=[],{inheritElems:o}=this.recipeConfig,h=Object.entries(e.skills).slice(0,this.internalMaxSkills).filter(f=>f[1]<2).map(f=>this.compendium.getSkill(f[0])),g=Object.entries(e.skills).slice(0,this.internalMaxSkills).filter(f=>f[1]<100).map(f=>this.compendium.getSkill(f[0]));for(let f=0;f<o.length;f++)e.inherits&1<<f||s.push(o[o.length-f-1]);this.skills[this.blankSkill.element]=[this.blankSkill].concat(g),this.elems=this.recipeConfig.skillElems.filter(f=>this.skills[f]&&!s.includes(f)),this.form.patchValue({race:e.race,demon:e,ingreds:h.concat(Array(this.internalMaxSkills-h.length).fill(this.blankSkill)).map(f=>({searchSkill:!0,elem:"-",skill:f,race:"-",demon:"-"!==f.name?e:this.blankDemon}))})}static{this.\u0275fac=function(s){return new(s||r)(t.rXU(S.ok))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-recipe-generator"]],inputs:{maxSkills:"maxSkills",compendium:"compendium",squareChart:"squareChart",recipeConfig:"recipeConfig",lang:"lang"},features:[t.OA$],decls:46,vars:45,consts:[[3,"formGroup"],[1,"entry-table"],["colspan","2",1,"title"],[2,"width","40%"],[2,"width","60%"],["formControlName","race",3,"change"],[3,"value",4,"ngFor","ngForOf"],["formControlName","demon",3,"change"],[3,"ngValue",4,"ngFor","ngForOf"],["formArrayName","ingreds",1,"entry-table"],["colspan","5",1,"title"],[2,"width","20%"],[2,"width","10%"],[2,"width","25%"],[3,"formGroupName",4,"ngFor","ngForOf"],["class","entry-table",4,"ngIf"],[3,"value"],[3,"ngValue"],[3,"formGroupName"],[4,"ngIf"],["formControlName","searchSkill","type","checkbox",3,"change"],["formControlName","elem",3,"change"],["value","-"],["formControlName","skill",3,"change"],["formControlName","demon",4,"ngIf"],["formControlName","demon"],["style","width: 50%",4,"ngIf"],["style","width: 50%","style","padding: 1em; text-align: center;",4,"ngIf"],["colspan","2",2,"padding","1em","text-align","center"],[2,"width","50%"],[4,"ngFor","ngForOf"],[2,"padding","1em","text-align","center"]],template:function(s,o){1&s&&(t.j41(0,"form",0)(1,"h2"),t.EFF(2),t.nI1(3,"translateComp"),t.k0s(),t.j41(4,"table",1)(5,"tr")(6,"th",2),t.EFF(7),t.nI1(8,"translateComp"),t.k0s()(),t.j41(9,"tr")(10,"th",3),t.EFF(11),t.nI1(12,"translateComp"),t.k0s(),t.j41(13,"th",4),t.EFF(14),t.nI1(15,"translateComp"),t.k0s()(),t.j41(16,"tr")(17,"td")(18,"select",5),t.bIt("change",function(){return o.setDemon(o.demons[o.form.controls.race.value][0])}),t.DNE(19,p,2,2,"option",6),t.k0s()(),t.j41(20,"td")(21,"select",7),t.bIt("change",function(){return o.setDemon(o.form.controls.demon.value)}),t.DNE(22,_,2,2,"option",8),t.k0s()()()(),t.j41(23,"table",9)(24,"tr")(25,"th",10),t.EFF(26),t.nI1(27,"translateComp"),t.k0s()(),t.j41(28,"tr")(29,"th",11),t.EFF(30),t.nI1(31,"translateComp"),t.k0s(),t.j41(32,"th",12),t.EFF(33),t.nI1(34,"translateComp"),t.k0s(),t.j41(35,"th",13),t.EFF(36),t.nI1(37,"translateComp"),t.k0s(),t.j41(38,"th",11),t.EFF(39),t.nI1(40,"translateComp"),t.k0s(),t.j41(41,"th",13),t.EFF(42),t.nI1(43,"translateComp"),t.k0s()(),t.DNE(44,pt,2,2,"ng-container",14),t.k0s(),t.DNE(45,V,22,19,"table",15),t.k0s()),2&s&&(t.Y8G("formGroup",o.form),t.R7$(2),t.JRh(t.i5U(3,15,o.msgs.RecipeGenerator,o.lang)),t.R7$(5),t.JRh(t.i5U(8,18,o.msgs.Target,o.lang)),t.R7$(4),t.JRh(t.i5U(12,21,o.msgs.Race,o.lang)),t.R7$(3),t.JRh(t.i5U(15,24,o.msgs.Name,o.lang)),t.R7$(5),t.Y8G("ngForOf",o.races),t.R7$(3),t.Y8G("ngForOf",o.demons[o.form.controls.race.value]),t.R7$(4),t.JRh(t.i5U(27,27,o.msgs.IncludeIngredients,o.lang)),t.R7$(4),t.JRh(t.i5U(31,30,o.msgs.FilterBy,o.lang)),t.R7$(3),t.JRh(t.i5U(34,33,o.msgs.Elem,o.lang)),t.R7$(3),t.JRh(t.i5U(37,36,o.msgs.Skill,o.lang)),t.R7$(3),t.JRh(t.i5U(40,39,o.msgs.Race,o.lang)),t.R7$(3),t.JRh(t.i5U(43,42,o.msgs.Ingredient,o.lang)),t.R7$(2),t.Y8G("ngForOf",o.form.controls.ingreds.controls),t.R7$(1),t.Y8G("ngIf",o.recipe))},dependencies:[k.Sq,k.bT,S.qT,S.xH,S.y7,S.Zm,S.wz,S.BC,S.cb,S.j4,S.JD,S.$R,S.v8,l.uz],styles:["ul[_ngcontent-%COMP%]{padding:0 1em;list-style:none}td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-height:25px;width:100%}"],changeDetection:0})}}return r})()},6122:(Z,K,u)=>{u.d(K,{L:()=>k});var l=u(3885),n=u(9108),i=u(1090),a=u(2598),D=u(177),I=u(8935),N=u(4207);const L=function(){return{exact:!0}};function U(p,_){if(1&p&&(a.j41(0,"th",4)(1,"a",5),a.EFF(2),a.nI1(3,"translateComp"),a.k0s()()),2&p){const R=_.$implicit,c=a.XpG();a.xc7("width",100/c.fusionOptions.length,"%"),a.Y8G("routerLink",R.link)("routerLinkActiveOptions",a.lJ4(9,L)),a.R7$(1),a.Y8G("routerLink",R.link),a.R7$(1),a.JRh(a.i5U(3,6,R.title,c.lang))}}function W(p,_){if(1&p&&(a.j41(0,"tr")(1,"th",6),a.EFF(2),a.nI1(3,"translateComp"),a.k0s()()),2&p){const R=a.XpG();a.R7$(1),a.BMQ("colspan",R.fusionOptions.length),a.R7$(1),a.SpI(" ",a.i5U(3,2,R.msgs.DlcExcluded,R.lang)," ")}}function t(p,_){if(1&p&&(a.j41(0,"tr")(1,"th",6),a.SdG(2),a.k0s()()),2&p){const R=a.XpG();a.R7$(1),a.BMQ("colspan",R.fusionOptions.length)}}const S=["*"];let k=(()=>{class p{constructor(){this.hasTripleFusion=!1,this.showFusionAlert=!1,this.excludedDlc=!1,this.lang="en",this.msgs=i.Lq,this.fusionOptions=[{title:this.msgs.NormalFissions,link:"fissions"},{title:this.msgs.NormalFusions,link:"fusions"}]}ngOnInit(){this.hasTripleFusion&&(this.fusionOptions=[{title:this.msgs.DoubleFissions,link:"fissions"},{title:this.msgs.TripleFissions,link:"fissions/triple"},{title:this.msgs.TripleFusions,link:"fusions/triple"},{title:this.msgs.DoubleFusions,link:"fusions"}])}ngOnChanges(){setTimeout(()=>this.stickyTable.nextEdges())}static{this.\u0275fac=function(c){return new(c||p)}}static{this.\u0275cmp=a.VBU({type:p,selectors:[["app-smt-fusions"]],viewQuery:function(c,T){if(1&c&&a.GBs(n.a,5),2&c){let d;a.mGM(d=a.lsd())&&(T.stickyTable=d.first)}},inputs:{hasTripleFusion:"hasTripleFusion",showFusionAlert:"showFusionAlert",excludedDlc:"excludedDlc",lang:"lang"},features:[a.Jv_([l.P]),a.OA$],ngContentSelectors:S,decls:11,vars:3,consts:[["appPositionSticky","",1,"list-table"],["stickyTable",""],["class","nav","routerLinkActive","active",3,"routerLink","width","routerLinkActiveOptions",4,"ngFor","ngForOf"],[4,"ngIf"],["routerLinkActive","active",1,"nav",3,"routerLink","routerLinkActiveOptions"],[3,"routerLink"],[1,"title"]],template:function(c,T){1&c&&(a.NAR(),a.j41(0,"div")(1,"table",0,1)(3,"thead")(4,"tr"),a.DNE(5,U,4,10,"th",2),a.k0s(),a.DNE(6,W,4,5,"tr",3),a.nrm(7,"tr"),a.DNE(8,t,3,1,"tr",3),a.nrm(9,"tr"),a.k0s()(),a.nrm(10,"router-outlet"),a.k0s()),2&c&&(a.R7$(5),a.Y8G("ngForOf",T.fusionOptions),a.R7$(1),a.Y8G("ngIf",T.excludedDlc),a.R7$(2),a.Y8G("ngIf",T.showFusionAlert))},dependencies:[D.Sq,D.bT,I.n3,I.Wk,I.wQ,n.a,N.uz],encapsulation:2,changeDetection:0})}}return p})()},8948:(Z,K,u)=>{u.d(K,{I:()=>n});var l=u(2598);let n=(()=>{class i{constructor(D,I){this.changeDetector2=D,this.fusionDataService2=I,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.fusionDataService2.compendium.subscribe(D=>{this.changeDetector2.markForCheck(),this.compendium=D})),this.subscriptions.push(this.fusionDataService2.fusionSettings.subscribe(D=>{this.fusionSettings=D}))}ngOnDestroy(){for(const D of this.subscriptions)D.unsubscribe()}toggleAll(D){const I={};for(const N of this.fusionSettings.displayHeaders)for(const L of N.settings)I[L.name]=D;this.fusionDataService2.updateFusionSettings(I)}toggleName(D){const I={};I[D]=!this.fusionSettings.isEnabled(D),this.fusionDataService2.updateFusionSettings(I)}static{this.\u0275fac=function(I){l.QTQ()}}static{this.\u0275dir=l.FsC({type:i})}}return i})()},1939:(Z,K,u)=>{u.d(K,{U:()=>l});class l{constructor(i,a,D=","){this.separator=D,this._displayHeaders=[],this._demonToggles={},this._subappToggles={};for(const{category:N,unlocked:L,conditions:U}of i){const W=[];this._displayHeaders.push({category:N,settings:W});for(const t of Object.keys(U))this._demonToggles[t]=L,W.push({name:t,caption:t.split(D).join(", "),enabled:L})}const I=[];a.length>0&&this._displayHeaders.push({category:"Subapps",settings:I});for(const N of a)this._subappToggles[N]=!1,I.push({name:N,caption:N,enabled:!1})}get displayHeaders(){for(const i of this._displayHeaders)for(const a of i.settings)a.enabled=this.saveFile[a.name];return this._displayHeaders}get subappToggles(){return this._subappToggles}get demonToggles(){const i={};for(const[a,D]of Object.entries(this._demonToggles))for(const I of a.split(this.separator))i[I]=D;return i}get saveFile(){return Object.assign({},this._demonToggles,this._subappToggles)}isEnabled(i){return this._demonToggles[i]||this._subappToggles[i]||!1}updateSaveFile(i){for(const a of[this._demonToggles,this._subappToggles])for(const[D,I]of Object.entries(i))a[D]===!I&&(a[D]=I)}}}}]);