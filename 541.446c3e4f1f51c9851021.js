(self.webpackChunkmegaten_fusion_tool=self.webpackChunkmegaten_fusion_tool||[]).push([[541],{5314:(e,t,s)=>{"use strict";s.d(t,{V:()=>X});var n=s(3522),i=s(5614),a=s(6746),o=s(7089),l=s(1116);let r=(()=>{class e{constructor(e){this.appCssClasses=["smt4","smt4f"],this.appCssClasses=e.compConfig.appCssClasses,this.langEn="ja"!==e.compConfig.lang,this.otherLinks=this.langEn?[{title:"Recipe Generator",link:"recipes"}]:[]}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(a.Y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-smt4f-compendium"]],decls:1,vars:2,consts:[[3,"ngClass","otherLinks"]],template:function(e,t){1&e&&i._UZ(0,"app-demon-compendium",0),2&e&&i.Q6J("ngClass",t.appCssClasses)("otherLinks",t.otherLinks)},directives:[o.e,l.mk],styles:[".smt4 div.element-icon{height:12px;background-size:12px;background-repeat:no-repeat;background-position:50%;color:transparent}.smt4 div.element-icon.phy{background-image:url(/assets/images/smtsj/phy.png)}.smt4 div.element-icon.gun{background-image:url(/assets/images/smt4f/gun.png)}.smt4 div.element-icon.fir{background-image:url(/assets/images/smtsj/fir.png)}.smt4 div.element-icon.ice{background-image:url(/assets/images/smtsj/ice.png)}.smt4 div.element-icon.ele{background-image:url(/assets/images/smtsj/ele.png)}.smt4 div.element-icon.for{background-image:url(/assets/images/smt4f/force.png)}.smt4 div.element-icon.lig{background-image:url(/assets/images/smtsj/exp.png)}.smt4 div.element-icon.dar{background-image:url(/assets/images/smtsj/cur.png)}.smt4 div.element-icon.ail{background-image:url(/assets/images/smtsj/ail.png)}.smt4 div.element-icon.rec{background-image:url(/assets/images/smtsj/rec.png)}.smt4 div.element-icon.alm{background-image:url(/assets/images/smtsj/alm.png)}.smt4 div.element-icon.sup{background-image:url(/assets/images/smtsj/sup.png)}.smt4 div.element-icon.pas{background-image:url(/assets/images/smtsj/pas.png)}.smt4 div.element-icon.oth,.smt4 div.element-icon.sab,.smt4 div.element-icon.spe{background-image:url(/assets/images/smtsj/spe.png)}.smt4 div.element-icon.com{background-image:url(/assets/images/smtsj/sup.png)}.smt4 td.affinity-8,.smt4 td.affinity-9{color:red}.smt4 td.affinity-7{color:#ff4500}.smt4 td.affinity-6{color:tomato}.smt4 td.affinity-5{color:coral}.smt4 td.affinity-4{color:#ff8c00}.smt4 td.affinity-3{color:orange}.smt4 td.affinity-2{color:#ffa07a}.smt4 td.affinity-1{color:gold}.smt4 td.affinity0{color:transparent}.smt4 td.affinity1{color:#7cfc00}.smt4 td.affinity2{color:#0f0}.smt4 td.affinity3{color:#00ff7f}.smt4 td.affinity4{color:#00fa9a}.smt4 td.affinity5{color:#32cd32}.smt4 td.affinity6{color:#3cb371}.smt4 td.affinity7{color:#2e8b57}.smt4 td.affinity8,.smt4 td.affinity9{color:#228b22}.smt4f th.nav.active,.smt4f th.nav.active a,.smt4f th.title{background-color:#fff;color:#000}.smt5 th.nav.active,.smt5 th.nav.active a,.smt5 th.title{background-color:#363361;color:#fff}.sh2 th.nav.active,.sh2 th.nav.active a,.sh2 th.title{background-color:#693cbe;color:#fff}"],encapsulation:2,changeDetection:0}),e})();var c=s(5438),m=s(9624),p=s(4008);let f=(()=>{class e extends c.l{constructor(e,t,s){super(e,t,s),this.compConfig=s.compConfig,this.langEn="ja"!==this.compConfig.lang,this.appName=(this.langEn?"List of Demons - ":"\u60aa\u9b54\u4e00\u89a7 ")+s.appName,this.defaultSortFun=(e,t)=>200*(this.compConfig.raceOrder[e.race]-this.compConfig.raceOrder[t.race])+t.lvl-e.lvl}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(m.Dx),i.Y36(i.sBO),i.Y36(a.Y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-demon-list-container"]],features:[i.qOj],decls:2,vars:8,consts:[[3,"langEn","raceOrder","statHeaders","resistHeaders","affinityHeaders","rowData"]],template:function(e,t){1&e&&(i._UZ(0,"app-smt-demon-list",0),i.ALo(1,"async")),2&e&&i.Q6J("langEn",t.langEn)("raceOrder",t.compConfig.raceOrder)("statHeaders",t.compConfig.baseStats)("resistHeaders",t.compConfig.resistElems)("affinityHeaders",t.compConfig.affinityElems)("rowData",i.lcZ(1,6,t.demons))},directives:[p.Q],pipes:[l.Ov],encapsulation:2,changeDetection:0}),e})();var u=s(9261),g=s(3787);let h=(()=>{class e extends u.e{constructor(e,t,s){super(e,t,s),this.appName=`List of Skills - ${s.appName}`,this.compConfig=s.compConfig,this.langEn="ja"!==this.compConfig.lang,this.appName=(this.langEn?"List of Skills - ":" \u30b9\u30ad\u30eb\u4e00\u89a7 ")+s.appName,this.compConfig=s.compConfig,this.defaultSortFun=(e,t)=>1e4*(this.compConfig.elemOrder[e.element]-this.compConfig.elemOrder[t.element])+e.rank-t.rank}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(m.Dx),i.Y36(i.sBO),i.Y36(a.Y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-skill-list-container"]],features:[i.qOj],decls:2,vars:6,consts:[[3,"langEn","elemOrder","hasTarget","rowData"]],template:function(e,t){1&e&&(i._UZ(0,"app-smt-skill-list",0),i.ALo(1,"async")),2&e&&i.Q6J("langEn",t.langEn)("elemOrder",t.compConfig.elemOrder)("hasTarget",!0)("rowData",i.lcZ(1,4,t.skills))},directives:[g.J],pipes:[l.Ov],encapsulation:2,changeDetection:0}),e})();var d=s(9805),v=s(8623);let C=(()=>{class e extends d.f{constructor(e,t){super(e,t),this.changeDetector=e,this.fusionDataService=t,this.langEn=!0,this.appTitle=t.appName,this.langEn="ja"!==t.compConfig.lang}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.sBO),i.Y36(a.Y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-demon-dlc-settings-container"]],features:[i.qOj],decls:1,vars:4,consts:[[3,"langEn","dlcDemons","appTitle","dlcTitle","toggledName"]],template:function(e,t){1&e&&(i.TgZ(0,"app-demon-dlc-settings",0),i.NdJ("toggledName",function(e){return t.toggleName(e)}),i.qZA()),2&e&&i.Q6J("langEn",t.langEn)("dlcDemons",t.dlcDemons)("appTitle",t.appTitle)("dlcTitle",t.langEn?"Included DLC Demons":"DLC")},directives:[v.d],encapsulation:2,changeDetection:0}),e})();var k=s(2573),b=s(858),D=s(4354),E=s(628),y=s(3015),T=s(4897),Z=s(6101),O=s(3966);function _(e,t){if(1&e&&i._UZ(0,"app-demon-inherits",10),2&e){const e=i.oxw(2);i.Q6J("langEn",e.langEn)("hasLvls",!0)("inheritHeaders",e.compConfig.affinityElems)("inherits",e.demon.affinities)}}function x(e,t){1&e&&(i.TgZ(0,"tr"),i.TgZ(1,"th"),i._uU(2,"Elem"),i.qZA(),i.TgZ(3,"th"),i._uU(4,"Name"),i.qZA(),i.TgZ(5,"th"),i._uU(6,"Cost"),i.qZA(),i.TgZ(7,"th"),i._uU(8,"Effect"),i.qZA(),i.TgZ(9,"th"),i._uU(10,"Target"),i.qZA(),i.TgZ(11,"th"),i._uU(12,"Rank"),i.qZA(),i.TgZ(13,"th"),i._uU(14,"Level"),i.qZA(),i.qZA())}function S(e,t){1&e&&(i.TgZ(0,"tr"),i.TgZ(1,"th"),i._uU(2,"\u5c5e\u6027"),i.qZA(),i.TgZ(3,"th"),i._uU(4,"\u30b9\u30ad\u30eb\u540d"),i.qZA(),i.TgZ(5,"th"),i._uU(6,"\u6d88\u8cbb"),i.qZA(),i.TgZ(7,"th"),i._uU(8,"\u8aac\u660e"),i.qZA(),i.TgZ(9,"th"),i._uU(10,"\u7bc4\u56f2"),i.qZA(),i.TgZ(11,"th"),i._uU(12,"\u30e9\u30f3\u30af"),i.qZA(),i.TgZ(13,"th"),i._uU(14,"Lvl"),i.qZA(),i.qZA())}const A=function(e){return{unique:e}};function j(e,t){if(1&e&&(i.TgZ(0,"tr",11),i.TgZ(1,"td"),i.TgZ(2,"div"),i._uU(3),i.qZA(),i.qZA(),i.TgZ(4,"td"),i._uU(5),i.qZA(),i.TgZ(6,"td"),i._uU(7),i.ALo(8,"skillCostToString"),i.qZA(),i.TgZ(9,"td"),i._uU(10),i.qZA(),i.TgZ(11,"td"),i._uU(12),i.qZA(),i.TgZ(13,"td"),i._uU(14),i.qZA(),i.TgZ(15,"td"),i._uU(16),i.ALo(17,"skillLevelToString"),i.qZA(),i.qZA()),2&e){const e=t.$implicit;i.Q6J("ngClass",i.VKq(19,A,e.skill.rank>90)),i.xp6(2),i.Gre("element-icon ",e.skill.element,""),i.xp6(1),i.Oqu(e.skill.element),i.xp6(2),i.Oqu(e.skill.name+(e.lvl?" +"+e.lvl:"")),i.xp6(1),i.Udp("color",e.cost?null:"transparent"),i.xp6(1),i.Oqu(i.lcZ(8,15,e.cost)),i.xp6(3),i.Oqu(e.skill.effect+(e.upgrade?" (+"+e.upgrade+"%)":"")),i.xp6(2),i.Oqu(e.skill.target||"Self"),i.xp6(1),i.Udp("color",99!==e.skill.rank?null:"transparent"),i.xp6(1),i.Oqu(e.skill.rank),i.xp6(2),i.Oqu(i.lcZ(17,17,e.skill.level))}}function q(e,t){if(1&e&&(i.TgZ(0,"tr"),i.TgZ(1,"td",12),i._uU(2),i.qZA(),i.qZA()),2&e){const e=i.oxw(2);i.xp6(2),i.Oqu(e.langEn?"No Learned Skills Found":"\u30b9\u30ad\u30eb\u306a\u3057")}}const L=function(e){return[e]};function U(e,t){if(1&e&&i._UZ(0,"app-fusion-entry-table",13),2&e){const e=i.oxw(2);i.Q6J("title",e.langEn?"Evolves From":"\u5909\u7570\u304b\u3089")("langEn",e.langEn)("baseUrl","..")("rowData",i.VKq(4,L,e.demon.evolvesFrom))}}function N(e,t){if(1&e&&i._UZ(0,"app-fusion-entry-table",13),2&e){const e=i.oxw(2);i.Q6J("title",e.langEn?"Evolves To":"\u5909\u7570")("langEn",e.langEn)("baseUrl","..")("rowData",i.VKq(4,L,e.demon.evolvesTo))}}function w(e,t){if(1&e&&(i.ynx(0),i._UZ(1,"app-demon-stats",2),i._UZ(2,"app-demon-resists",3),i.YNc(3,_,1,4,"app-demon-inherits",4),i.TgZ(4,"table",5),i.TgZ(5,"thead"),i.TgZ(6,"tr"),i.TgZ(7,"th",6),i._uU(8),i.qZA(),i.qZA(),i.YNc(9,x,15,0,"tr",0),i.YNc(10,S,15,0,"tr",0),i.qZA(),i.TgZ(11,"tbody"),i.YNc(12,j,18,21,"tr",7),i.YNc(13,q,3,1,"tr",0),i._UZ(14,"tr"),i.qZA(),i.qZA(),i.YNc(15,U,1,6,"app-fusion-entry-table",8),i.YNc(16,N,1,6,"app-fusion-entry-table",8),i._UZ(17,"app-smt-fusions",9),i.BQk()),2&e){const e=i.oxw();i.xp6(1),i.Q6J("langEn",e.langEn)("title","Lvl "+e.demon.lvl+" "+e.demon.race+" "+e.demon.name)("price",e.demon.price)("statHeaders",e.compConfig.baseStats)("stats",e.demon.stats),i.xp6(1),i.Q6J("langEn",e.langEn)("resistHeaders",e.compConfig.resistElems)("resists",e.demon.resists)("ailmentHeaders",e.compConfig.ailmentElems)("ailments",e.demon.ailments),i.xp6(1),i.Q6J("ngIf",e.demon.affinities),i.xp6(5),i.Oqu(e.langEn?"Learned Skills":"\u7fd2\u5f97\u30b9\u30ad\u30eb"),i.xp6(1),i.Q6J("ngIf",e.langEn),i.xp6(1),i.Q6J("ngIf",!e.langEn),i.xp6(2),i.Q6J("ngForOf",e.skillLvls),i.xp6(1),i.Q6J("ngIf",!e.skillLvls.length),i.xp6(2),i.Q6J("ngIf",e.demon.evolvesFrom),i.xp6(1),i.Q6J("ngIf",e.demon.evolvesTo),i.xp6(1),i.Q6J("langEn",e.langEn)("excludedDlc","excluded"===e.demon.fusion)}}function J(e,t){if(1&e&&i._UZ(0,"app-demon-missing",14),2&e){const e=i.oxw();i.Q6J("name",e.name)}}let Y=(()=>{class e{constructor(){this.langEn=!0,this.skillLvls=[]}ngOnChanges(){if(this.demon){this.skillLvls=[];for(const e of Object.keys(this.demon.skills)){const t=this.compendium.getSkill(e);let s=0,n=t.cost,i=0;if(this.demon.affinities&&n<2e3){const e=this.compConfig.affinityElems.indexOf(t.element);s=e>-1?this.demon.affinities[e]:0,i=s>0?this.compConfig.affinityBonuses.upgrades[e][s-1]:0,s>0&&n>0&&(n=1e3+Math.floor((100-this.compConfig.affinityBonuses.costs[e][s-1])/100*(t.cost-1e3)))}this.skillLvls.push({skill:t,cost:n,lvl:s,upgrade:i})}for(const e of this.skillLvls)e.skill.level=this.demon.skills[e.skill.name];this.skillLvls.sort((e,t)=>20*(e.skill.level-t.skill.level)+this.compConfig.elemOrder[e.skill.element]-this.compConfig.elemOrder[t.skill.element])}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-demon-entry"]],inputs:{name:"name",demon:"demon",compConfig:"compConfig",compendium:"compendium",langEn:"langEn"},features:[i.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[3,"name",4,"ngIf"],[3,"langEn","title","price","statHeaders","stats"],[3,"langEn","resistHeaders","resists","ailmentHeaders","ailments"],[3,"langEn","hasLvls","inheritHeaders","inherits",4,"ngIf"],[1,"entry-table"],["colSpan","7",1,"title"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"title","langEn","baseUrl","rowData",4,"ngIf"],[3,"langEn","excludedDlc"],[3,"langEn","hasLvls","inheritHeaders","inherits"],[3,"ngClass"],["colSpan","7"],[3,"title","langEn","baseUrl","rowData"],[3,"name"]],template:function(e,t){1&e&&(i.YNc(0,w,18,20,"ng-container",0),i.YNc(1,J,1,1,"app-demon-missing",1)),2&e&&(i.Q6J("ngIf",t.demon),i.xp6(1),i.Q6J("ngIf",!t.demon))},directives:[l.O5,k.O,b.I,l.sg,D.O,E.N,l.mk,y.P,T.t],pipes:[Z.tq,Z.Lu],encapsulation:2,changeDetection:0}),e})(),I=(()=>{class e{constructor(e,t,s,n){this.route=e,this.title=t,this.currentDemonService=s,this.fusionDataService=n,this.subscriptions=[],this.appName="Test App",this.appName=n.appName,this.compConfig=n.compConfig}ngOnInit(){this.subscribeAll()}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}subscribeAll(){this.subscriptions.push(this.fusionDataService.compendium.subscribe(e=>{this.compendium=e,this.getDemonEntry()})),this.subscriptions.push(this.currentDemonService.currentDemon.subscribe(e=>{this.name=e,this.getDemonEntry()})),this.route.params.subscribe(e=>{this.currentDemonService.nextCurrentDemon(e.demonName)})}getDemonEntry(){this.compendium&&this.name&&(this.title.setTitle(this.name+("ja"!==this.compConfig.lang?" - ":" ")+this.appName),this.demon=this.compendium.getDemon(this.name))}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(n.gz),i.Y36(m.Dx),i.Y36(O.s),i.Y36(a.Y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-demon-entry-container"]],decls:1,vars:5,consts:[[3,"langEn","name","demon","compConfig","compendium"]],template:function(e,t){1&e&&i._UZ(0,"app-demon-entry",0),2&e&&i.Q6J("langEn","ja"!==t.compConfig.lang)("name",t.name)("demon",t.demon)("compConfig",t.compConfig)("compendium",t.compendium)},directives:[Y],encapsulation:2,changeDetection:0}),e})();var R=s(7967);function Q(e,t){if(1&e&&i._UZ(0,"app-fusion-chart",2),2&e){const e=i.oxw();i.Q6J("langEn",e.langEn)("normChart",e.normChart)("tripChart",e.normChart)("normTitle",e.langEn?"Light and Neutral Normal Fusions":"LIGHT\u5408\u4f53")("tripTitle",e.langEn?"Dark Normal Fusions":"DARK\u5408\u4f53")}}function H(e,t){if(1&e&&i._UZ(0,"app-fusion-chart",3),2&e){const e=i.oxw();i.Q6J("langEn",e.langEn)("filterDarks",!1)("normChart",e.normChart)}}let F=(()=>{class e{constructor(e,t){this.changeDetectorRef=e,this.fusionDataService=t,this.subscriptions=[]}ngOnInit(){this.langEn="ja"!==this.fusionDataService.compConfig.lang,this.hasLightDark=!this.fusionDataService.compConfig.appCssClasses.includes("sh2"),this.subscriptions.push(this.fusionDataService.fusionChart.subscribe(e=>{this.changeDetectorRef.markForCheck(),this.normChart=e}))}ngOnDestroy(){for(const e of this.subscriptions)e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(i.sBO),i.Y36(a.Y))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-fusion-chart-container"]],decls:2,vars:2,consts:[[3,"langEn","normChart","tripChart","normTitle","tripTitle",4,"ngIf"],[3,"langEn","filterDarks","normChart",4,"ngIf"],[3,"langEn","normChart","tripChart","normTitle","tripTitle"],[3,"langEn","filterDarks","normChart"]],template:function(e,t){1&e&&(i.YNc(0,Q,1,5,"app-fusion-chart",0),i.YNc(1,H,1,3,"app-fusion-chart",1)),2&e&&(i.Q6J("ngIf",t.hasLightDark),i.xp6(1),i.Q6J("ngIf",!t.hasLightDark))},directives:[l.O5,R.R],encapsulation:2,changeDetection:0}),e})();var B=s(3810);let K=(()=>{class e{constructor(e,t){this.fusionDataService=e,this.title=t,this.subscriptions=[],this.defaultDemon="Pixie",this.maxSkills=8;const s=this.fusionDataService.compConfig,n=s.appCssClasses.includes("sh2");this.maxSkills=n?6:8,this.recipeConfig={fissionCalculator:this.fusionDataService.fissionCalculator,fusionCalculator:this.fusionDataService.fusionCalculator,races:s.races,skillElems:s.skillElems,inheritElems:s.affinityElems,restrictInherits:n}}ngOnInit(){this.setTitle(),this.subscribeAll()}ngOnDestroy(){this.unsubscribeAll()}setTitle(){this.title.setTitle(`Recipe Generator - ${this.fusionDataService.appName}`)}subscribeAll(){this.subscriptions.push(this.fusionDataService.compendium.subscribe(e=>{this.compendium=e})),this.subscriptions.push(this.fusionDataService.fusionChart.subscribe(e=>{this.fusionChart=e}))}unsubscribeAll(){for(const e of this.subscriptions)e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(i.Y36(a.Y),i.Y36(m.Dx))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-recipe-generator-container"]],decls:1,vars:5,consts:[[3,"defaultDemon","maxSkills","compendium","fusionChart","recipeConfig"]],template:function(e,t){1&e&&i._UZ(0,"app-recipe-generator",0),2&e&&i.Q6J("defaultDemon",t.defaultDemon)("maxSkills",t.maxSkills)("compendium",t.compendium)("fusionChart",t.fusionChart)("recipeConfig",t.recipeConfig)},directives:[B.X],encapsulation:2,changeDetection:0}),e})();var V=s(5946),G=s(2060);const M=[{path:"",redirectTo:"demons",pathMatch:"full"},{path:"",component:r,data:{fusionTool:"chart"},children:[{path:"chart",component:F}]},{path:"",component:r,children:[{path:"demons/:demonName",component:I,children:[{path:"fissions",component:V.t},{path:"fusions",component:G.$},{path:"**",redirectTo:"fissions",pathMatch:"full"}]},{path:"demons",component:f},{path:"skills",component:h},{path:"recipes",component:K},{path:"settings",component:C}]},{path:"**",redirectTo:"demons",pathMatch:"full"}];let X=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=i.oAB({type:e}),e.\u0275inj=i.cJS({imports:[[n.Bz.forChild(M)],n.Bz]}),e})()},6746:(e,t,s)=>{"use strict";s.d(t,{Y:()=>h});var n=s(8512);function i(e,t){const s={};for(const[n,i]of Object.entries(e)){const e=Object.assign({},i),a={};for(const[s,n]of Object.entries(i.skills))a[t[s]||s]=n;e.race=t[e.race]||e.race,e.skills=a,s[t[n]||n]=e}return s}function a(e,t){const s={};for(const[n,i]of Object.entries(e)){const e=Object.assign({},i),a=e.target||"Self";e.target=t[a]||a,s[t[n]||n]=e}return s}function o(e,t){const s={};for(const[n,i]of Object.entries(e))s[t[n]||n]=i.map(e=>t[e]||e);return s}function l(e,t){const s={};for(const[n,i]of Object.entries(e))s[t[n]||n]={lvl:i.lvl,result:t[i.result]||i.result};return s}function r(e,t){const s={races:e.races.map(e=>t[e]||e),table:e.table.map(e=>e.map(e=>t[e]||e))};return e.elems&&(s.elems=e.elems.map(e=>t[e]||e),s.table=e.table),s}class c{constructor(e){this.compConfig=e,this._dlcDemons={Cleopatra:!1,Mephisto:!1},this.initImportedData(),this.updateDerivedData()}initImportedData(){const e={},t={},s={},n={},i={},a=Array(this.compConfig.ailmentElems.length).fill(100),o={1125:[],50:[],0:[]},l="ja"!==this.compConfig.lang,r=l?"Innate resistance":"",c=l?"Self":"\u81ea\u8eab",m=l?{1125:"Weak ",50:"Resist ",0:"Null "}:{1125:"\u5f31",50:"\u5f37",0:"\u7121"};for(const[p,f]of Object.entries(m))for(const e of this.compConfig.ailmentElems)o[p].push({name:f+e,element:"pas",effect:r,target:c,cost:0,rank:99,learnedBy:[],level:0});for(const[p,f]of Object.entries(this.compConfig.demonData))e[p]={name:p,race:f.race,lvl:f.lvl,currLvl:f.currLvl||f.lvl,skills:f.skills,price:2*f.price,inherits:parseInt((f.affinities||[-9]).map(e=>e<=-9?"0":"1").join(""),2),stats:f.stats,resists:f.resists.split("").map(e=>this.compConfig.resistCodes[e]),affinities:f.affinities,ailments:f.ailments?f.ailments.split("").map(e=>this.compConfig.resistCodes[e]):a,fusion:f.fusion||"normal",prereq:f.prereq||""};for(const[p,f]of Object.entries(this.compConfig.skillData))t[p]={name:p,element:f.element,rank:f.rank,effect:f.effect,damage:f.damage||"",target:f.target||"Self",hits:f.hits||"",cost:f.cost||0,learnedBy:[],level:0},t[p].rank||(t[p].rank=99);for(const p of Object.values(o))for(const e of p)t[e.name]=e;for(const[p,f]of Object.entries(this.compConfig.specialRecipes)){const t=[],i=[];for(const e of f)if(e.includes(" x")){const[t,s]=e.split(" x ");i.push({name1:t,name2:s})}else t.push(e);t.length>0&&(s[p]=t),i.length>0&&(n[p]=i),"normal"===e[p].fusion&&(e[p].fusion="special")}for(const[p,f]of Object.entries(this.compConfig.evolveData)){const t=f.result;e[p].evolvesTo={price:e[t].price,race1:e[t].race,lvl1:f.lvl,name1:t},e[t].evolvesFrom={price:e[p].price,race1:e[p].race,lvl1:f.lvl,name1:p}}for(const p of this.compConfig.races)i[p]={};for(const[p,f]of Object.entries(e))i[f.race][f.lvl]=p;for(const p of Object.values(e).sort((e,t)=>e.currLvl-t.currLvl))if("enemy"!==p.fusion){for(const e of Object.keys(p.skills))t[e].learnedBy.push({demon:p.name,level:p.skills[e]});for(let e=0;e<p.ailments.length;e++)o[p.ailments[e]]&&o[p.ailments[e]][e].learnedBy.push({demon:p.name,level:0})}this._dlcDemons=this.compConfig.dlcDemons.reduce((e,t)=>(e[t]=!1,e),{}),this.demons=e,this.skills=t,this.specialRecipes=s,this.specialPairRecipes=n,this.invertedDemons=i}updateDerivedData(){const e=Object.assign({},this.demons),t=Object.keys(this.skills).map(e=>this.skills[e]),s={},n={};for(const i of this.compConfig.races)s[i]=[],n[i]=[];for(const[i,a]of Object.entries(this.demons))this.isElementDemon(i)||this.isOverlappingResult(i)||s[a.race].push(a.lvl),this.specialRecipes.hasOwnProperty(i)||n[a.race].push(a.lvl);for(const i of this.compConfig.races)s[i].sort((e,t)=>e-t),n[i].sort((e,t)=>e-t);for(const i of this.compConfig.races){const e=s[i],t=n[i],a=e.length,o=t.length;a&&o&&e[a-1]!==t[o-1]&&t.push(100)}for(const[i,a]of Object.entries(this._dlcDemons))for(const t of i.split(","))if(this.demons[t]){if(!a){const{race:i,lvl:a}=this.demons[t];delete e[t],s[i]=s[i].filter(e=>e!==a),n[i]=n[i].filter(e=>e!==a)}this.demons[t].fusion=a?"special":"excluded"}this._allDemons=Object.keys(e).map(t=>e[t]),this._allSkills=t.filter(e=>e.rank<99||e.learnedBy.length>0),this.allIngredients=s,this.allResults=n}get dlcDemons(){return this._dlcDemons}set dlcDemons(e){this._dlcDemons=e,this.updateDerivedData()}get allDemons(){return this._allDemons}get allSkills(){return this._allSkills}get specialDemons(){return Object.keys(this.specialRecipes).map(e=>this.demons[e])}getDemon(e){return this.demons[e]}getSkill(e){return this.skills[e]}getSkills(e){const t=this.compConfig.elemOrder,s=e.map(e=>this.skills[e]);return s.sort((e,s)=>1e4*(t[e.element]-t[s.element])+e.rank-s.rank),s}getIngredientDemonLvls(e){return this.allIngredients[e]||[]}getResultDemonLvls(e){return this.allResults[e]||[]}getSpecialNameEntries(e){return this.specialRecipes[e]||[]}getSpecialNamePairs(e){return this.specialPairRecipes[e]||[]}reverseLookupDemon(e,t){return this.invertedDemons[e][t]}reverseLookupSpecial(e){return[]}isElementDemon(e){return"Element"===this.demons[e].race}isOverlappingResult(e){return!1}}var m=s(6829);let p=(()=>{class e extends m.g{constructor(e){super(),this.initCharts(e)}initCharts(e){const t=e.normalTable.races,s=e.normalTable.table,n=e.elementTable.elems,i=e.elementTable.races,a=e.elementTable.table;this.lvlModifier=e.lvlModifier,this.elementDemons=n,this.fusionChart=m.g.loadFusionTableJson(t,s),this.fissionChart=m.g.loadFissionTableJson(t,n,s),this.elementChart=m.g.loadElementTableJson(i,n,a),this.races=t}getLightDark(t){return-1!==e.LIGHT_RACES.indexOf(t)?1:-1!==e.DARK_RACES.indexOf(t)?-1:0}}return e.LIGHT_RACES=["Herald","Megami","Avian","Tree","Deity","Avatar","Holy","Genma","Fury","Lady","Dragon","Kishin","Enigma","Entity","Wargod","Amatsu","Kunitsu","Godly","Chaos","\u5927\u5929\u4f7f","\u5973\u795e","\u970a\u9ce5","\u795e\u6a39","\u9b54\u795e","\u795e\u7363","\u8056\u7363","\u5e7b\u9b54","\u7834\u58ca\u795e","\u5730\u6bcd\u795e","\u9f8d\u795e","\u9b3c\u795e","\u79d8\u795e","\u5a01\u970a","\u8ecd\u795e","\u5929\u6d25\u795e","\u56fd\u6d25\u795e","\u795e\u970a","\u6df7\u6c8c\u738b"],e.DARK_RACES=["Vile","Raptor","Wood","Reaper","Wilder","Jaki","Vermin","Tyrant","Drake","Spirit","Haunt","Ghost","Zealot","\u90aa\u795e","\u51f6\u9ce5","\u5996\u6a39","\u6b7b\u795e","\u5996\u7363","\u90aa\u9b3c","\u5e7d\u866b","\u9b54\u738b","\u90aa\u9f8d","\u60aa\u970a","\u5e7d\u9b3c","\u5e7d\u9b3c","\u72c2\u795e"],e})();var f=s(115),u=s(5614),g=s(3522);let h=(()=>{class e{constructor(e,t){this.fissionCalculator=f.uC,this.fusionCalculator=f.YP,this.compConfig=t.url.includes("/ja/")?function(e){const t=e.engNames,s=e.races.map(e=>t[e]||e);return{appTitle:t[e.appTitle]||e.appTitle,races:s,raceOrder:e.raceOrder,appCssClasses:e.appCssClasses,lang:"ja",engNames:e.engNames,affinityElems:e.affinityElems,skillData:a(e.skillData,t),skillElems:e.skillElems,elemOrder:e.elemOrder,resistCodes:e.resistCodes,affinityBonuses:e.affinityBonuses,lvlModifier:e.lvlModifier,demonData:i(e.demonData,t),evolveData:l(e.evolveData,t),dlcDemons:e.dlcDemons.map(e=>e.split(",").map(e=>t[e]||e).join(",")),baseStats:e.baseStats.map(e=>t[e]||e),resistElems:e.resistElems,ailmentElems:e.ailmentElems.map(e=>t[e]||e),normalTable:r(e.normalTable,t),elementTable:r(e.elementTable,t),specialRecipes:o(e.specialRecipes,t),settingsKey:e.settingsKey.replace("-ja","")+"-ja",settingsVersion:e.settingsVersion}}(e):e,this.appName=this.compConfig.appTitle+("ja"!==this.compConfig.lang?" Fusion Calculator":" \u5408\u4f53\u30a2\u30d7\u30ea"),this._compendium=new c(this.compConfig),this._compendium$=new n.X(this._compendium),this.compendium=this._compendium$.asObservable(),this._fusionChart=new p(this.compConfig),this._fusionChart$=new n.X(this._fusionChart),this.fusionChart=this._fusionChart$.asObservable();const s=JSON.parse(localStorage.getItem(this.compConfig.settingsKey));s&&s.version&&s.version>=this.compConfig.settingsVersion&&this.nextDlcDemons(s.dlcDemons),window.addEventListener("storage",this.onStorageUpdated.bind(this))}nextDlcDemons(e){localStorage.setItem(this.compConfig.settingsKey,JSON.stringify({version:this.compConfig.settingsVersion,dlcDemons:e})),this._compendium.dlcDemons=e,this._compendium$.next(this._compendium)}onStorageUpdated(e){switch(e.key){case this.compConfig.settingsKey:this._compendium.dlcDemons=JSON.parse(e.newValue).dlcDemons,this._compendium$.next(this._compendium)}}}return e.\u0275fac=function(t){return new(t||e)(u.LFG(f.I7),u.LFG(g.F0))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac}),e})()},4541:(e,t,s)=>{"use strict";s.d(t,{D:()=>r});var n=s(1116),i=s(5425),a=s(6487),o=s(5314),l=s(5614);let r=(()=>{class e{static forRoot(){return{ngModule:e}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[n.ez,i.m,a.a,o.V]]}),e})()}}]);