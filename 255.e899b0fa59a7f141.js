"use strict";(self.webpackChunkmegaten_fusion_tool=self.webpackChunkmegaten_fusion_tool||[]).push([[255],{609:(Z,Y,_)=>{_.d(Y,{d:()=>e});var r=_(4412);class e{constructor(a,k,I,N,P){this.settingsKey=N,this.settingsVersion=P,this._compendium=a,this._compendium$=new r.t(this._compendium),this.compendium=this._compendium$.asObservable(),this._fusionChart=k,this._fusionChart$=new r.t(this._fusionChart),this.fusionChart=this._fusionChart$.asObservable(),this._fusionSettings=I,this._fusionSettings$=new r.t(this._fusionSettings),this.fusionSettings=this._fusionSettings$.asObservable();const B=JSON.parse(localStorage.getItem(this.settingsKey));B&&B.version&&B.version>=this.settingsVersion&&this.updateFusionSettings(B.settings),window.addEventListener("storage",this.onStorageUpdated.bind(this))}updateToggledSettings(a){this._fusionSettings.updateSaveFile(a),this._compendium.updateFusionSettings(this._fusionSettings.demonToggles),this._compendium$.next(this._compendium),this._fusionSettings$.next(this._fusionSettings)}onStorageUpdated(a){a.key===this.settingsKey&&this.updateToggledSettings(JSON.parse(a.newValue).settings)}updateFusionSettings(a){this.updateToggledSettings(a),localStorage.setItem(this.settingsKey,JSON.stringify({version:this.settingsVersion,settings:this._fusionSettings.saveFile}))}}},9436:(Z,Y,_)=>{_.d(Y,{d:()=>d});var r=_(1090),e=_(2598),i=_(177),a=_(4207);function k(c,b){if(1&c&&(e.j41(0,"th",4),e.EFF(1,"Inheritable Skills"),e.k0s()),2&c){const m=e.XpG();e.BMQ("colspan",m.inheritHeaders.length)}}function I(c,b){if(1&c&&(e.j41(0,"th",4),e.EFF(1),e.nI1(2,"translateComp"),e.k0s()),2&c){const m=e.XpG();e.BMQ("colspan",m.inheritHeaders.length),e.R7$(1),e.SpI(" ",e.i5U(2,2,m.msgs.SkillAffinities,m.lang)," ")}}function N(c,b){if(1&c&&(e.qex(0),e.EFF(1),e.bVm()),2&c){const m=e.XpG().$implicit;e.R7$(1),e.JRh(m)}}function P(c,b){if(1&c&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&c){const m=e.XpG().$implicit;e.ZvI("element-icon ",m,""),e.R7$(1),e.JRh(m)}}function B(c,b){if(1&c&&(e.j41(0,"th"),e.DNE(1,N,2,1,"ng-container",3),e.DNE(2,P,2,4,"div",5),e.k0s()),2&c){const m=e.XpG();e.xc7("width",100/m.inheritHeaders.length,"%"),e.R7$(1),e.Y8G("ngIf",!m.hasIcons),e.R7$(1),e.Y8G("ngIf",m.hasIcons)}}function W(c,b){if(1&c&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&c){const m=b.$implicit;e.xc7("color",m?null:"transparent"),e.R7$(1),e.SpI(" ",m?"yes":"no"," ")}}function t(c,b){if(1&c&&(e.j41(0,"tr"),e.DNE(1,W,2,3,"td",6),e.k0s()),2&c){const m=e.XpG();e.R7$(1),e.Y8G("ngForOf",m.inherits)}}function S(c,b){if(1&c&&(e.j41(0,"td"),e.nI1(1,"roundInheritPercent"),e.EFF(2),e.k0s()),2&c){const m=b.$implicit;e.ZvI("affinity",e.bMT(1,4,m),""),e.R7$(2),e.SpI(" ",m,"% ")}}function F(c,b){if(1&c&&(e.j41(0,"tr"),e.DNE(1,S,3,6,"td",7),e.k0s()),2&c){const m=e.XpG();e.R7$(1),e.Y8G("ngForOf",m.inherits)}}function f(c,b){if(1&c&&(e.j41(0,"td"),e.EFF(1),e.nI1(2,"affinityToString"),e.k0s()),2&c){const m=b.$implicit;e.ZvI("affinity",m,""),e.R7$(1),e.SpI(" ",e.bMT(2,4,m)," ")}}function h(c,b){if(1&c&&(e.j41(0,"tr"),e.DNE(1,f,3,6,"td",7),e.k0s()),2&c){const m=e.XpG();e.R7$(1),e.Y8G("ngForOf",m.inherits)}}let d=(()=>{class c{constructor(){this.inheritHeaders=[],this.inherits=[],this.hasChance=!1,this.hasIcons=!0,this.hasLvls=!1,this.lang="en",this.msgs=r.dx}static{this.\u0275fac=function(x){return new(x||c)}}static{this.\u0275cmp=e.VBU({type:c,selectors:[["app-demon-inherits"]],inputs:{inheritHeaders:"inheritHeaders",inherits:"inherits",hasChance:"hasChance",hasIcons:"hasIcons",hasLvls:"hasLvls",lang:"lang"},decls:11,vars:6,consts:[[1,"entry-table"],["class","title",4,"ngIf"],[3,"width",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"title"],[3,"class",4,"ngIf"],[3,"color",4,"ngFor","ngForOf"],[3,"class",4,"ngFor","ngForOf"]],template:function(x,w){1&x&&(e.j41(0,"table",0)(1,"thead")(2,"tr"),e.DNE(3,k,2,1,"th",1),e.DNE(4,I,3,5,"th",1),e.k0s(),e.j41(5,"tr"),e.DNE(6,B,3,4,"th",2),e.k0s()(),e.j41(7,"tbody"),e.DNE(8,t,2,1,"tr",3),e.DNE(9,F,2,1,"tr",3),e.DNE(10,h,2,1,"tr",3),e.k0s()()),2&x&&(e.R7$(3),e.Y8G("ngIf",!w.hasLvls),e.R7$(1),e.Y8G("ngIf",w.hasLvls&&w.inheritHeaders.length),e.R7$(2),e.Y8G("ngForOf",w.inheritHeaders),e.R7$(2),e.Y8G("ngIf",!w.hasLvls&&!w.hasChance),e.R7$(1),e.Y8G("ngIf",w.hasChance),e.R7$(1),e.Y8G("ngIf",w.hasLvls))},dependencies:[i.Sq,i.bT,a.uz,a.XM,a.D8],encapsulation:2,changeDetection:0})}}return c})()},3679:(Z,Y,_)=>{_.d(Y,{C:()=>f});var r=_(1090),e=_(2598),i=_(177),a=_(4207);function k(h,d){if(1&h&&(e.j41(0,"h2"),e.EFF(1),e.k0s()),2&h){const c=e.XpG();e.R7$(1),e.JRh(c.title)}}function I(h,d){if(1&h&&(e.j41(0,"th"),e.EFF(1),e.nI1(2,"translateComp"),e.k0s()),2&h){const c=e.XpG();e.R7$(1),e.JRh(e.i5U(2,1,c.msgs.Price,c.lang))}}function N(h,d){if(1&h&&(e.j41(0,"th"),e.EFF(1),e.k0s()),2&h){const c=d.$implicit;e.R7$(1),e.JRh(c)}}function P(h,d){1&h&&(e.j41(0,"th"),e.EFF(1,"Inherits"),e.k0s())}function B(h,d){if(1&h&&(e.j41(0,"th"),e.EFF(1),e.k0s()),2&h){const c=d.$implicit;e.R7$(1),e.JRh(c)}}function W(h,d){if(1&h&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&h){const c=e.XpG();e.R7$(1),e.JRh(c.price)}}function t(h,d){if(1&h&&(e.j41(0,"td"),e.EFF(1),e.k0s()),2&h){const c=d.$implicit;e.R7$(1),e.JRh(c)}}function S(h,d){if(1&h&&(e.j41(0,"td")(1,"div"),e.EFF(2),e.k0s()()),2&h){const c=e.XpG();e.R7$(1),e.ZvI("element-icon i",c.inherits,""),e.R7$(1),e.JRh(c.inherits)}}const F=["*"];let f=(()=>{class h{constructor(){this.title="Demon Entry",this.statHeaders=[],this.stats=[],this.fusionHeaders=[],this.price=0,this.lang="en",this.msgs=r.Cj}static{this.\u0275fac=function(b){return new(b||h)}}static{this.\u0275cmp=e.VBU({type:h,selectors:[["app-demon-stats"]],inputs:{title:"title",statHeaders:"statHeaders",stats:"stats",fusionHeaders:"fusionHeaders",inherits:"inherits",price:"price",lang:"lang"},ngContentSelectors:F,decls:20,vars:13,consts:[[4,"ngIf"],[1,"entry-table"],[1,"title"],[4,"ngFor","ngForOf"]],template:function(b,m){1&b&&(e.NAR(),e.qex(0),e.DNE(1,k,2,1,"h2",0),e.j41(2,"table",1)(3,"thead")(4,"tr")(5,"th",2),e.EFF(6),e.nI1(7,"translateComp"),e.k0s()(),e.j41(8,"tr"),e.DNE(9,I,3,4,"th",0),e.DNE(10,N,2,1,"th",3),e.DNE(11,P,2,0,"th",0),e.DNE(12,B,2,1,"th",3),e.k0s()(),e.j41(13,"tbody")(14,"tr"),e.DNE(15,W,2,1,"td",0),e.DNE(16,t,2,1,"td",3),e.DNE(17,S,3,4,"td",0),e.SdG(18),e.k0s()()(),e.eu8(19),e.bVm()),2&b&&(e.R7$(1),e.Y8G("ngIf",m.title.includes("Lvl")),e.R7$(4),e.BMQ("colSpan",m.stats.length+m.fusionHeaders.length+(m.inherits?1:0)+(m.price?1:0)),e.R7$(1),e.SpI(" ",m.title.includes("Lvl")?e.i5U(7,10,m.msgs.Stats,m.lang):m.title," "),e.R7$(3),e.Y8G("ngIf",m.price),e.R7$(1),e.Y8G("ngForOf",m.statHeaders),e.R7$(1),e.Y8G("ngIf",m.inherits),e.R7$(1),e.Y8G("ngForOf",m.fusionHeaders),e.R7$(3),e.Y8G("ngIf",m.price),e.R7$(1),e.Y8G("ngForOf",m.stats),e.R7$(1),e.Y8G("ngIf",m.inherits))},dependencies:[i.Sq,i.bT,a.uz],encapsulation:2,changeDetection:0})}}return h})()},9023:(Z,Y,_)=>{_.d(Y,{q:()=>S});var r=_(2755),e=_(1090),i=_(2598),a=_(345),k=_(8935),I=_(177);function N(F,f){if(1&F&&(i.j41(0,"th"),i.EFF(1),i.k0s()),2&F){const h=f.$implicit,d=i.XpG();i.R7$(1),i.JRh(h.slice(0,d.nameCut))}}function P(F,f){if(1&F&&(i.j41(0,"td",4),i.EFF(1),i.k0s()),2&F){const h=f.$implicit,d=i.XpG(2);i.Y8G("ngClass",h.slice(0,4)),i.R7$(1),i.JRh(h.slice(4,d.nameCut+4))}}function B(F,f){if(1&F&&(i.j41(0,"tr")(1,"th"),i.EFF(2),i.k0s(),i.DNE(3,P,2,2,"td",3),i.j41(4,"th"),i.EFF(5),i.k0s()()),2&F){const h=f.$implicit;i.R7$(2),i.JRh(h[0]),i.R7$(1),i.Y8G("ngForOf",h.slice(1,h.length-1)),i.R7$(2),i.JRh(h[h.length-1])}}function W(F,f){if(1&F&&(i.j41(0,"th"),i.EFF(1),i.k0s()),2&F){const h=f.$implicit,d=i.XpG();i.R7$(1),i.JRh(h.slice(0,d.nameCut))}}function t(F,f){if(1&F&&(i.j41(0,"tr")(1,"th",0),i.EFF(2),i.k0s()()),2&F){const h=i.XpG();i.R7$(1),i.BMQ("colspan",h.table[0].length),i.R7$(1),i.Lme("",h.appName," ",h.tripTitle,"")}}class S{static{this.RESULT_COLORS=Object.entries({oran:["-2","Erthys","Gnome","Saki","Saki Mitama","Random","\u30a2\u30fc\u30b7\u30fc\u30ba","\u30ce\u30fc\u30e0","\u30b5\u30ad\u30df\u30bf\u30de"],redd:["-1","Flaemis","Salamander","Ara ","Ara Mitama","Fiend","\u30d5\u30ec\u30a4\u30df\u30fc\u30ba","\u30b5\u30e9\u30de\u30f3\u30c0\u30fc","\u30a2\u30e9\u30df\u30bf\u30de"],gree:["1","Aeros","Sylph","Kusi","Kusi Mitama","UMA","\u30a8\u30a2\u30ed\u30b9","\u30b7\u30eb\u30ad\u30fc","\u30af\u30b7\u30df\u30bf\u30de"],blue:["2","Aquans","Undine","Nigi","Nigi Mitama","Enigma","\u30a2\u30af\u30a2\u30f3\u30ba","\u30a6\u30f3\u30c7\u30a3\u30fc\u30cd","\u30cb\u30ae\u30df\u30bf\u30de"]})}constructor(f,h){this.title2=f,this.route=h,this.normTitle="Normal Fusions",this.tripTitle="",this.isPersona=!1,this.filterDarks=!0,this.lang="en",this.msgs=e.qh,this.subscriptions=[],this.table=[],this.nameCut=4}ngOnInit(){this.subscriptions.push(this.route.parent.data.subscribe(f=>{this.appName=f.appName||"Shin Megami Tensei",this.nameCut=parseInt((0,r.oO)(this.msgs.NameCut,f.lang)),this.title2.setTitle((0,r.oO)(this.msgs.AppTitle,f.lang).replace("$APP",this.appName))}))}ngOnChanges(){this.normChart&&this.fillFusionChart()}ngOnDestroy(){for(const f of this.subscriptions)f.unsubscribe()}fillFusionChart(){const f="noneNone",d=S.RESULT_COLORS.reduce((v,[M,X])=>X.reduce((J,tt)=>(J[tt]=M,J),v),{}),c=this.normChart.elementDemons;let b=[],m=this.normChart.races,x=[];this.filterDarks&&(b=this.normChart.races.filter(v=>this.normChart.getLightDark(v)>0),m=this.normChart.races.filter(v=>0===this.normChart.getLightDark(v)),x=this.normChart.races.filter(v=>-1===this.normChart.getLightDark(v)),0===x.length&&b.length>0&&(b=this.normChart.races.filter(v=>this.normChart.getLightDark(v)>-1),m=[],x=this.normChart.races.filter(v=>this.normChart.getLightDark(v)<-1)));const w=b.length-x.length,z=b.concat(m,c),it=x.length?x.concat(Array(z.length-x.length).fill("")):z,gt=this.mitaTable?z:b.concat(m,Array(c.length).fill("")),ot=this.mitaTable||x.length?Array(w).fill("").concat(x,m,c):z;this.table=[[""].concat(z,[""])];for(let v=0;v<ot.length;v++){const M=Array(z.length+2).fill("empt-"),X=ot[v],J=gt[v],tt=-1!==c.indexOf(X),_t=-1!==c.indexOf(J);this.table.push(M),M[0]=X,M[M.length-1]=J;for(let A=v;A<z.length;A++){const U=z[A],V=-1!==c.indexOf(U);if(V&&_t){const H=c.indexOf(J),l=c.indexOf(U),g=this.mitaTable[l][H].replace("-","");M[A+1]=g?(d[g]||"norm")+g:f}else if(V&&J){const H=this.normChart.getElemFusions(U)[J];M[A+1]=H?(d[H]||"rank")+(H>0?"+":"")+H.toString():f}else if(U&&J){const H=this.isPersona&&U===J?U:this.normChart.getRaceFusion(U,J);M[A+1]=H?(d[H]||(U===J?"elem":"norm"))+H:f}}if(this.tripChart)for(let A=0;A<=v-w;A++){const U=it[A];if(U&&tt){const V=this.tripChart.getElemFusions(X)[U];M[A+1]=V?(d[V]||"rank")+(V>0?"+":"")+V.toString():f}else if(U&&X){const V=this.tripChart.getRaceFusion(U,X);M[A+1]=V?(d[V]||(U===X?"elem":"trip"))+V:f}}if(-1!==X.indexOf(" x ")){const[A,U]=X.split(" x "),V=A.slice(0,3)+"x"+U.slice(0,3);M[0]=V,M[M.length-1]=V}else if(-1!==X.indexOf(" ")){const A=X.split(" ")[0];M[0]=A,M[M.length-1]=A}}for(let v=0;v<this.table[0].length;v++){const M=this.table[0][v];if(-1!==M.indexOf(" x ")){const[X,J]=M.split(" x ");this.table[0][v]=X.slice(0,2)+J.slice(0,2)}}this.table.push([""].concat(it,[""]))}static{this.\u0275fac=function(h){return new(h||S)(i.rXU(a.hE),i.rXU(k.nX))}}static{this.\u0275cmp=i.VBU({type:S,selectors:[["app-fusion-chart"]],inputs:{normChart:"normChart",tripChart:"tripChart",mitaTable:"mitaTable",normTitle:"normTitle",tripTitle:"tripTitle",isPersona:"isPersona",filterDarks:"filterDarks",lang:"lang",counter:"counter"},features:[i.OA$],decls:12,vars:7,consts:[[1,"title"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(h,d){1&h&&(i.j41(0,"table")(1,"tbody")(2,"tr")(3,"th",0),i.EFF(4),i.k0s()(),i.j41(5,"tr"),i.DNE(6,N,2,1,"th",1),i.k0s(),i.DNE(7,B,6,3,"tr",1),i.j41(8,"tr"),i.DNE(9,W,2,1,"th",1),i.k0s(),i.DNE(10,t,3,3,"tr",2),i.k0s(),i.nrm(11,"tbody"),i.k0s()),2&h&&(i.R7$(3),i.BMQ("colspan",d.table[0].length),i.R7$(1),i.Lme("",d.appName," ",d.normTitle,""),i.R7$(2),i.Y8G("ngForOf",d.table[0]),i.R7$(1),i.Y8G("ngForOf",d.table.slice(1,d.table.length-1)),i.R7$(2),i.Y8G("ngForOf",d.table[d.table.length-1]),i.R7$(1),i.Y8G("ngIf",d.tripTitle))},dependencies:[I.YU,I.Sq,I.bT],styles:["table[_ngcontent-%COMP%]{width:auto;margin:0 auto;white-space:nowrap}td.elem[_ngcontent-%COMP%]{color:#0f0}td.trip[_ngcontent-%COMP%]{color:#d3d3d3}td.oran[_ngcontent-%COMP%]{color:orange}td.redd[_ngcontent-%COMP%]{color:red}td.gree[_ngcontent-%COMP%]{color:#0f0}td.blue[_ngcontent-%COMP%]{color:#0ff}td.none[_ngcontent-%COMP%]{color:transparent}td.empt[_ngcontent-%COMP%]{background-color:transparent;color:transparent}"],changeDetection:0})}}},860:(Z,Y,_)=>{_.d(Y,{B:()=>W});var r=_(2598),e=_(2755),i=_(1090),a=_(345),k=_(177),I=_(4207);function N(t,S){if(1&t){const F=r.RV6();r.qex(0),r.j41(1,"tr")(2,"th"),r.EFF(3,"All Demons"),r.k0s()(),r.j41(4,"tr")(5,"td")(6,"button",4),r.bIt("click",function(){r.eBV(F);const h=r.XpG();return r.Njj(h.toggledAll.emit(!0))}),r.EFF(7,"Enable All"),r.k0s(),r.j41(8,"button",4),r.bIt("click",function(){r.eBV(F);const h=r.XpG();return r.Njj(h.toggledAll.emit(!1))}),r.EFF(9,"Disable All"),r.k0s()()(),r.bVm()}}function P(t,S){if(1&t){const F=r.RV6();r.j41(0,"tr")(1,"td")(2,"label"),r.EFF(3),r.j41(4,"input",5),r.bIt("change",function(){const d=r.eBV(F).$implicit,c=r.XpG(2);return r.Njj(c.toggledName.emit(d.name))}),r.k0s()()()()}if(2&t){const F=S.$implicit;r.R7$(3),r.SpI("",F.caption," "),r.R7$(1),r.Y8G("checked",F.enabled)}}function B(t,S){if(1&t&&(r.qex(0),r.j41(1,"tr")(2,"th"),r.EFF(3),r.k0s()(),r.DNE(4,P,5,2,"tr",3),r.bVm()),2&t){const F=S.$implicit;r.R7$(3),r.JRh(F.category),r.R7$(1),r.Y8G("ngForOf",F.settings)}}let W=(()=>{class t{constructor(F){this.title=F,this.lang="en",this.showEnableAll=!1,this.toggledAll=new r.bkB,this.toggledName=new r.bkB,this.msgs=i.BR}set appTitle(F){this.title.setTitle((0,e.oO)(this.msgs.AppTitle,this.lang)+F)}static{this.\u0275fac=function(f){return new(f||t)(r.rXU(a.hE))}}static{this.\u0275cmp=r.VBU({type:t,selectors:[["app-fusion-settings"]],inputs:{dlcDemons:"dlcDemons",lang:"lang",fusionSettings:"fusionSettings",showEnableAll:"showEnableAll",appTitle:"appTitle"},outputs:{toggledAll:"toggledAll",toggledName:"toggledName"},decls:12,vars:6,consts:[[1,"entry-table"],[1,"title"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","50%",3,"click"],["type","checkbox",3,"checked","change"]],template:function(f,h){1&f&&(r.qex(0),r.j41(1,"h2"),r.EFF(2),r.nI1(3,"translateComp"),r.k0s(),r.j41(4,"table",0)(5,"thead")(6,"tr")(7,"th",1),r.EFF(8,"Unlock Conditions"),r.k0s()()(),r.j41(9,"tbody"),r.DNE(10,N,10,0,"ng-container",2),r.DNE(11,B,5,2,"ng-container",3),r.k0s()(),r.bVm()),2&f&&(r.R7$(2),r.JRh(r.i5U(3,3,h.msgs.DlcTitle,h.lang)),r.R7$(8),r.Y8G("ngIf",h.showEnableAll),r.R7$(1),r.Y8G("ngForOf",h.fusionSettings.displayHeaders))},dependencies:[k.Sq,k.bT,I.uz],encapsulation:2,changeDetection:0})}}return t})()},1289:(Z,Y,_)=>{_.d(Y,{h:()=>H});var r=_(4207),e=_(4660);function a(l,g){return parseInt(g.map(n=>l.includes(n)?"1":"0").join(""),2)||0}function k(l,g){return l.map((n,s,o)=>a(o.slice(0,s+1),g))}function N(l,g,n,s,o,p){let u=n,R=[u];const O=s.getSpecialNameEntries(u),j=g[g.length-1];if(0!==O.length&&(u=O.find(T=>0===s.getSpecialNameEntries(T).length),R.unshift(O.filter(T=>T!==u).join(" x ")),R.unshift(u)),l.length>0){const T=function B(l,g,n,s,o){const{fusionCalculator:p}=o,u=l.slice(0,1);if(l.length<2)return u;let R=u[0],O=g[0];for(let j=1;j<l.length;j++){const T=l[j],$=g[j],C=p.getFusions(R,n,s).map(G=>(0,e.lA)(G,n)).sort((G,Q)=>G.price-Q.price);let y=!1;for(const G of C)if(G.name1===T&&($&n.getDemon(G.name2).inherits)===$){u.push(T),u.push(G.name2),R=u[u.length-1],O=$,y=!0;break}if(y)continue;const K=p.getFusions(T,n,s).reduce((G,Q)=>(G[Q.name1]=Q.name2,G),{});for(const G of C)if(K[G.name2]&&(O&n.getDemon(G.name2).inherits)===O&&($&n.getDemon(K[G.name2]).inherits)===$){u.push(G.name1),u.push(G.name2),u.push(T),u.push(K[G.name2]),R=u[u.length-1],O=$,y=!0;break}if(!y)return[]}return u}(l,g,s,o,p);if(0===T.length)return[];const $=T[T.length-1];let C=P($,u,j,s,o,p);if(0===C.length){const y=s.getDemon(u),lt=s.getResultDemonLvls(y.race).map(K=>s.reverseLookupDemon(y.race,K)).filter(K=>K!==u);for(const K of o.elementDemons.concat(lt)){if((j&s.getDemon(K).inherits)!==j)continue;const G=P($,K,j,s,o,p),Q=P(K,u,j,s,o,p);if(0!==G.length&&0!==Q.length){C=G.concat(Q.slice(1));break}}}if(0===C.length)return[];R=T.concat(C.slice(1),R.slice(1))}return R}function P(l,g,n,s,o,p){const{fissionCalculator:u,fusionCalculator:R}=p,O=[l];if(l===g)return O;const j=R.getFusions(l,s,o).map(C=>(0,e.lA)(C,s)).sort((C,y)=>C.price-y.price);for(const C of j)if(C.name2===g)return O.push(C.name1),O.push(g),O;const T=u.getFusions(g,s,o).map(C=>(0,e.on)(C,s)).sort((C,y)=>C.price-y.price);j.sort((C,y)=>y.price-C.price);const $=j.reduce((C,y)=>(C[y.name2]=y.name1,C),{});for(const C of T){if($[C.name1]&&(n&s.getDemon(C.name1).inherits)===n)return O.push($[C.name1]),O.push(C.name1),O.push(C.name2),O.push(g),O;if($[C.name2]&&(n&s.getDemon(C.name2).inherits)===n)return O.push($[C.name2]),O.push(C.name2),O.push(C.name1),O.push(g),O}return[]}var W=_(1090),t=_(2598),S=_(4341),F=_(177);function f(l,g){if(1&l&&(t.j41(0,"option",16),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.Y8G("value",n),t.R7$(1),t.JRh(n)}}function h(l,g){if(1&l&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.Y8G("ngValue",n),t.R7$(1),t.JRh(n.name)}}function d(l,g){if(1&l&&(t.j41(0,"option",16),t.EFF(1),t.k0s()),2&l){const n=g.$implicit,s=t.XpG(3);t.Y8G("value",n),t.R7$(1),t.JRh(s.recipeConfig.displayElems[n]||n)}}function c(l,g){if(1&l&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.Y8G("ngValue",n),t.R7$(1),t.JRh(n.name)}}function b(l,g){if(1&l&&(t.j41(0,"option",16),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.Y8G("value",n),t.R7$(1),t.JRh(n)}}function m(l,g){if(1&l&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.Y8G("ngValue",n),t.R7$(1),t.JRh(n.name)}}function x(l,g){if(1&l&&(t.j41(0,"select",25),t.DNE(1,m,2,2,"option",8),t.k0s()),2&l){const n=t.XpG(2).$implicit,s=t.XpG();t.R7$(1),t.Y8G("ngForOf",s.learnedBy[n.controls.skill.value.name])}}function w(l,g){if(1&l&&(t.j41(0,"option",17),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.Y8G("ngValue",n),t.R7$(1),t.JRh(n.name)}}function z(l,g){if(1&l&&(t.j41(0,"select",25),t.DNE(1,w,2,2,"option",8),t.k0s()),2&l){const n=t.XpG(2).$implicit,s=t.XpG();t.R7$(1),t.Y8G("ngForOf",s.demons[n.controls.race.value])}}function it(l,g){if(1&l){const n=t.RV6();t.j41(0,"tr")(1,"td")(2,"label"),t.EFF(3),t.nI1(4,"translateComp"),t.j41(5,"input",20),t.bIt("change",function(){t.eBV(n);const o=t.XpG().$implicit,p=t.XpG();return t.Njj(p.setIngredDemon(o))}),t.k0s()()(),t.j41(6,"td")(7,"select",21),t.bIt("change",function(){t.eBV(n);const o=t.XpG().$implicit,p=t.XpG();return t.Njj(p.setIngredElem(o))}),t.j41(8,"option",22),t.EFF(9,"-"),t.k0s(),t.DNE(10,d,2,2,"option",6),t.k0s()(),t.j41(11,"td")(12,"select",23),t.bIt("change",function(){t.eBV(n);const o=t.XpG().$implicit,p=t.XpG();return t.Njj(p.setIngredDemon(o))}),t.DNE(13,c,2,2,"option",8),t.k0s()(),t.j41(14,"td")(15,"select",5),t.bIt("change",function(){t.eBV(n);const o=t.XpG().$implicit,p=t.XpG();return t.Njj(p.setIngredDemon(o))}),t.j41(16,"option",22),t.EFF(17,"-"),t.k0s(),t.DNE(18,b,2,2,"option",6),t.k0s()(),t.j41(19,"td"),t.DNE(20,x,2,1,"select",24),t.DNE(21,z,2,1,"select",24),t.k0s()()}if(2&l){const n=t.XpG(),s=n.index,o=n.$implicit,p=t.XpG();t.R7$(3),t.Lme("",t.i5U(4,10,p.msgs.LearnsSkill,p.lang),"",s+1," "),t.R7$(4),t.BMQ("disabled",!o.controls.searchSkill.value||null),t.R7$(3),t.Y8G("ngForOf",p.elems),t.R7$(2),t.BMQ("disabled",!o.controls.searchSkill.value||null),t.R7$(1),t.Y8G("ngForOf",p.skills[o.controls.elem.value]),t.R7$(2),t.BMQ("disabled",o.controls.searchSkill.value||null),t.R7$(3),t.Y8G("ngForOf",p.races),t.R7$(2),t.Y8G("ngIf",o.controls.searchSkill.value),t.R7$(1),t.Y8G("ngIf",!o.controls.searchSkill.value)}}function gt(l,g){if(1&l&&(t.qex(0,18),t.DNE(1,it,22,13,"tr",19),t.bVm()),2&l){const n=g.index,s=t.XpG();t.Y8G("formGroupName",n),t.R7$(1),t.Y8G("ngIf",n<s.maxSkills)}}function ot(l,g){if(1&l&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.R7$(1),t.JRh(n)}}function v(l,g){if(1&l&&(t.j41(0,"td",29)(1,"ul"),t.DNE(2,ot,2,1,"li",30),t.k0s()()),2&l){const n=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",n.recipeLeft)}}function M(l,g){if(1&l&&(t.j41(0,"td",31),t.EFF(1),t.nI1(2,"translateComp"),t.k0s()),2&l){const n=t.XpG(2);t.R7$(1),t.JRh(t.i5U(2,1,n.msgs.NoRecipesFound,n.lang))}}function X(l,g){if(1&l&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&l){const n=g.$implicit;t.R7$(1),t.JRh(n)}}function J(l,g){if(1&l&&(t.j41(0,"td",29)(1,"ul"),t.DNE(2,X,2,1,"li",30),t.k0s()()),2&l){const n=t.XpG(2);t.R7$(2),t.Y8G("ngForOf",n.recipeRight)}}function tt(l,g){if(1&l&&(t.j41(0,"td",31),t.EFF(1),t.nI1(2,"translateComp"),t.k0s()),2&l){const n=t.XpG(2);t.R7$(1),t.JRh(t.i5U(2,1,n.msgs.NoRecipesFound,n.lang))}}function _t(l,g){if(1&l&&(t.j41(0,"tr")(1,"td",28),t.EFF(2),t.nI1(3,"translateComp"),t.k0s()()),2&l){const n=t.XpG(2);t.R7$(2),t.Lme(" ",t.i5U(3,2,n.msgs.SpecialFusionCondition,n.lang),": ",n.fusionPrereq," ")}}function A(l,g){if(1&l&&(t.qex(0),t.EFF(1),t.nrm(2,"br"),t.EFF(3),t.bVm()),2&l){const n=t.XpG(2);t.R7$(1),t.Lme(" ",n.recipeResult.join(" x ")," = ",n.recipe.result,""),t.R7$(2),t.SpI(" [",n.resultSkills.join(", "),"] ")}}function U(l,g){if(1&l&&(t.qex(0),t.EFF(1),t.nI1(2,"translateComp"),t.bVm()),2&l){const n=t.XpG(2);t.R7$(1),t.JRh(t.i5U(2,1,n.msgs.NoRecipesFound,n.lang))}}function V(l,g){if(1&l&&(t.j41(0,"table",1)(1,"tr")(2,"th",2),t.EFF(3),t.nI1(4,"translateComp"),t.k0s()(),t.j41(5,"tr")(6,"th"),t.EFF(7),t.nI1(8,"translateComp"),t.k0s(),t.j41(9,"th"),t.EFF(10),t.nI1(11,"translateComp"),t.k0s()(),t.j41(12,"tr"),t.DNE(13,v,3,1,"td",26),t.DNE(14,M,3,4,"td",27),t.DNE(15,J,3,1,"td",26),t.DNE(16,tt,3,4,"td",27),t.k0s(),t.DNE(17,_t,4,5,"tr",19),t.j41(18,"tr")(19,"td",28),t.DNE(20,A,4,3,"ng-container",19),t.DNE(21,U,3,4,"ng-container",19),t.k0s()()()),2&l){const n=t.XpG();t.R7$(3),t.JRh(t.i5U(4,10,n.msgs.FusionRecipe,n.lang)),t.R7$(4),t.JRh(t.i5U(8,13,n.msgs.LeftChain,n.lang)),t.R7$(3),t.JRh(t.i5U(11,16,n.msgs.RightChain,n.lang)),t.R7$(3),t.Y8G("ngIf",n.recipeLeft.length),t.R7$(1),t.Y8G("ngIf",!n.recipeLeft.length),t.R7$(1),t.Y8G("ngIf",n.recipeRight.length),t.R7$(1),t.Y8G("ngIf",!n.recipeRight.length),t.R7$(1),t.Y8G("ngIf",n.fusionPrereq),t.R7$(3),t.Y8G("ngIf",n.recipe.stepR.length),t.R7$(1),t.Y8G("ngIf",!n.recipe.stepR.length)}}let H=(()=>{class l{constructor(n){this.fb=n,this.maxSkills=8,this.lang="en",this.internalMaxSkills=9,this.range99=Array(99),this.demons={},this.skills={},this.learnedBy={},this.fusionPrereq="",this.msgs=W.hV,this.skillLevelPipe=new r.wv,this.blankDemon={name:"-",race:"-",lvl:0,currLvl:0,price:0,inherits:0,skills:{},stats:[],resists:[],affinities:[],fusion:"normal",prereq:""},this.blankSkill={name:"-",element:"-",rank:99,cost:0,effect:"",target:"",level:0,learnedBy:[{demon:"-",level:0}]},this.createForm()}ngOnChanges(){this.initDropdowns()}createForm(){const n=[];for(let s=0;s<this.internalMaxSkills;s++)n.push(this.fb.group({searchSkill:!0,elem:"-",skill:this.blankSkill,race:{value:"-",disabled:!0},demon:this.blankDemon}));this.form=this.fb.group({race:"-",demon:this.blankDemon,ingreds:this.fb.array(n)}),this.form.valueChanges.subscribe(s=>{if(this.form.valid){const o=s.ingreds.filter(u=>"-"!==u.demon.name&&u.demon.name!==s.demon.name).map(u=>u.demon.name),p={};for(const u of s.ingreds)u.searchSkill&&"-"!==u.skill.name&&(p[u.skill.name]=u.demon.name);this.updateRecipe(function i(l,g,n,s,o,p){const{fissionCalculator:u,inheritElems:R,restrictInherits:O,triExclusiveRaces:j,triFissionCalculator:T}=p,{normalChart:$}=o,C=s.getDemon(l),y={};for(const[E,D]of Object.entries(n))"-"!==D&&D!==C.name&&(y[E]=D);const K=a(Object.keys(n).map(E=>s.getSkill(E)).map(E=>E.element),R);let G=s.getSpecialNameEntries(l);if(G.length<2&&j.includes(C.race)){const E=T.getFusions(l,s,o).map(D=>(0,e.f7)(D,s)).sort((D,L)=>D.price-L.price).find(D=>(K&(D.d1.inherits|D.d2.inherits))===K&&!j.includes(D.d1.race)&&!j.includes(D.d2.race)&&!j.includes(D.d3.race));E&&(G=[E.d1.name,E.d2.name,E.d3.name])}if(G.length<2){const E=u.getFusions(l,s,$).map(D=>(0,e.on)(D,s)).sort((D,L)=>D.price-L.price).find(D=>(K&(s.getDemon(D.name1).inherits|s.getDemon(D.name2).inherits))===K&&"normal"===s.getDemon(D.name1).fusion&&"normal"===s.getDemon(D.name2).fusion&&!j.includes(s.getDemon(D.name1).race)&&!j.includes(s.getDemon(D.name2).race));E&&(G=[E.name1,E.name2])}const Q=G.map(E=>s.getDemon(E)).sort((E,D)=>D.price-E.price),ft=Object.keys(y).map(E=>s.getSkill(E)),rt=a(ft.map(E=>E.element),R),Ft=ft.map(E=>a([E.element],R));let at,ut,dt=0;for(let E=0;E<Q.length;E++){const D=Q[E];for(const L of Q.slice(E+1))if((rt&(D.inherits|L.inherits))===rt){const Rt=(rt&D.inherits).toString(2).split("1").length*(rt&L.inherits).toString(2).split("1").length;dt<Rt&&(at=D,ut=L,dt=Rt)}}const ct={chain1:[],chain2:[],stepR:G,skills:y,result:l};if(!at)return ct;const et=Object.values(y).filter((E,D,L)=>L.indexOf(E)===D),ht=g.filter(E=>!et.includes(E));let q=Math.ceil(et.length/2);et.sort((E,D)=>$.getLightDark(s.getDemon(E).race)-$.getLightDark(s.getDemon(D).race));let nt=et.slice(0,q),mt=Array(nt.length).fill(0),st=et.slice(q),pt=Array(st.length).fill(0);if(O){const{left:E,right:D}=function I(l,g,n,s){let o=[],p=[];const u=[],R=[],O={},j=[];for(let T=0;T<n.length;T++){const $=n[T];0!==$?(O.hasOwnProperty($)||(O[$]=[]),O[$].push(s[T])):j.push(s[T])}for(const T of Object.keys(O).sort()){const $=parseInt(T);u.length<=R.length?($&l)===$?u.push($):R.push($):($&g)===$?R.push($):u.push($)}for(const T of u)o=o.concat(O[T]);for(const T of R)p=p.concat(O[T]);for(const T of j)o.length<p.length?o.push(T):p.push(T);return{left:o.reverse(),right:p.reverse()}}(at.inherits,ut.inherits,Ft,ft.map(L=>L.name));nt=E.map(L=>y[L]),mt=k(E.map(L=>s.getSkill(L).element),R),st=D.map(L=>y[L]),pt=k(D.map(L=>s.getSkill(L).element),R)}return q=Math.ceil(ht.length/2),nt=ht.slice(0,q).concat(nt),mt=Array(q).fill(0).concat(mt),st=ht.slice(q).concat(st),pt=Array(ht.length-q).fill(0).concat(pt),ct.chain1=N(nt,mt,at.name,s,$,p),ct.chain2=N(st,pt,ut.name,s,$,p),ct}(s.demon.name,o,p,this.compendium,this.squareChart,this.recipeConfig))}})}setIngredElem(n){n.controls.skill.setValue(this.skills[n.controls.elem.value][0]),this.setIngredDemon(n)}setIngredDemon(n){n.controls.demon.setValue((n.controls.searchSkill.value?this.learnedBy[n.controls.skill.value.name]:this.demons[n.controls.race.value])[0])}updateRecipe(n){const s={};for(const[o,p]of Object.entries(n.skills)){s[p]||(s[p]=[]);const u=this.compendium.getDemon(p).skills[o];s[p].push(`${o} ${this.skillLevelPipe.transform(u)}`.trim())}this.recipe=n,this.recipeLeft=this.decodeRecipechain(n.chain1,s),this.recipeRight=this.decodeRecipechain(n.chain2,s),this.resultSkills=[],this.recipeResult=[],this.fusionPrereq=this.compendium.getDemon(n.result).prereq||"";for(const o of n.stepR)this.recipeResult.push(s[o]?`${o} [${s[o].join(", ")}]`:o);for(const[o,p]of Object.entries(this.compendium.getDemon(n.result).skills).filter(u=>u[1]<2e3).sort((u,R)=>u[1]-R[1]))this.resultSkills.push(`${o} ${this.skillLevelPipe.transform(p)}`.trim())}decodeRecipechain(n,s){const o=[];for(let p=0;p<n.length-2;p+=2){const u=s[n[p]]?"["+s[n[p]].join(", ")+"] ":"",R=s[n[p+1]]?"["+s[n[p+1]].join(", ")+"] ":"";o.push(`${n[p]} ${u}x ${n[p+1]} ${R}= ${n[p+2]}`)}return o}initDropdowns(){if(this.recipeConfig&&this.compendium&&this.squareChart){this.demons={"-":[this.blankDemon]},this.skills={"-":[this.blankSkill]},this.learnedBy={"-":[this.blankDemon]};for(const n of this.compendium.allDemons)if(!n.isEnemy&&"party"!==n.fusion&&"enemy"!==n.fusion){this.demons[n.race]||(this.demons[n.race]=[]),this.demons[n.race].push(n);for(const s of Object.keys(n.skills))this.learnedBy[s]||(this.learnedBy[s]=[]),this.learnedBy[s].push(n)}for(const n of this.compendium.allSkills.filter(s=>s.rank<50&&s.learnedBy.length>0))this.skills[n.element]||(this.skills[n.element]=[]),this.skills[n.element].push(n);for(const n of Object.values(this.demons))n.sort((s,o)=>s.lvl-o.lvl);for(const n of Object.values(this.learnedBy))n.sort((s,o)=>s.lvl-o.lvl);for(const n of Object.values(this.skills))n.sort((s,o)=>s.rank-o.rank);this.races=this.recipeConfig.races.filter(n=>this.demons[n]),this.elems=this.recipeConfig.skillElems.filter(n=>this.skills[n]),this.setDemon(this.compendium.getDemon(this.recipeConfig.defaultDemon))}}setDemon(n){const s=[],{inheritElems:o}=this.recipeConfig,p=Object.entries(n.skills).slice(0,this.internalMaxSkills).filter(R=>R[1]<2).map(R=>this.compendium.getSkill(R[0])),u=Object.entries(n.skills).slice(0,this.internalMaxSkills).filter(R=>R[1]<100).map(R=>this.compendium.getSkill(R[0]));for(let R=0;R<o.length;R++)n.inherits&1<<R||s.push(o[o.length-R-1]);this.skills[this.blankSkill.element]=[this.blankSkill].concat(u),this.elems=this.recipeConfig.skillElems.filter(R=>this.skills[R]&&!s.includes(R)),this.form.patchValue({race:n.race,demon:n,ingreds:p.concat(Array(this.internalMaxSkills-p.length).fill(this.blankSkill)).map(R=>({searchSkill:!0,elem:"-",skill:R,race:"-",demon:"-"!==R.name?n:this.blankDemon}))})}static{this.\u0275fac=function(s){return new(s||l)(t.rXU(S.ok))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-recipe-generator"]],inputs:{maxSkills:"maxSkills",compendium:"compendium",squareChart:"squareChart",recipeConfig:"recipeConfig",lang:"lang"},features:[t.OA$],decls:46,vars:45,consts:[[3,"formGroup"],[1,"entry-table"],["colspan","2",1,"title"],[2,"width","40%"],[2,"width","60%"],["formControlName","race",3,"change"],[3,"value",4,"ngFor","ngForOf"],["formControlName","demon",3,"change"],[3,"ngValue",4,"ngFor","ngForOf"],["formArrayName","ingreds",1,"entry-table"],["colspan","5",1,"title"],[2,"width","20%"],[2,"width","10%"],[2,"width","25%"],[3,"formGroupName",4,"ngFor","ngForOf"],["class","entry-table",4,"ngIf"],[3,"value"],[3,"ngValue"],[3,"formGroupName"],[4,"ngIf"],["formControlName","searchSkill","type","checkbox",3,"change"],["formControlName","elem",3,"change"],["value","-"],["formControlName","skill",3,"change"],["formControlName","demon",4,"ngIf"],["formControlName","demon"],["style","width: 50%",4,"ngIf"],["style","width: 50%","style","padding: 1em; text-align: center;",4,"ngIf"],["colspan","2",2,"padding","1em","text-align","center"],[2,"width","50%"],[4,"ngFor","ngForOf"],[2,"padding","1em","text-align","center"]],template:function(s,o){1&s&&(t.j41(0,"form",0)(1,"h2"),t.EFF(2),t.nI1(3,"translateComp"),t.k0s(),t.j41(4,"table",1)(5,"tr")(6,"th",2),t.EFF(7),t.nI1(8,"translateComp"),t.k0s()(),t.j41(9,"tr")(10,"th",3),t.EFF(11),t.nI1(12,"translateComp"),t.k0s(),t.j41(13,"th",4),t.EFF(14),t.nI1(15,"translateComp"),t.k0s()(),t.j41(16,"tr")(17,"td")(18,"select",5),t.bIt("change",function(){return o.setDemon(o.demons[o.form.controls.race.value][0])}),t.DNE(19,f,2,2,"option",6),t.k0s()(),t.j41(20,"td")(21,"select",7),t.bIt("change",function(){return o.setDemon(o.form.controls.demon.value)}),t.DNE(22,h,2,2,"option",8),t.k0s()()()(),t.j41(23,"table",9)(24,"tr")(25,"th",10),t.EFF(26),t.nI1(27,"translateComp"),t.k0s()(),t.j41(28,"tr")(29,"th",11),t.EFF(30),t.nI1(31,"translateComp"),t.k0s(),t.j41(32,"th",12),t.EFF(33),t.nI1(34,"translateComp"),t.k0s(),t.j41(35,"th",13),t.EFF(36),t.nI1(37,"translateComp"),t.k0s(),t.j41(38,"th",11),t.EFF(39),t.nI1(40,"translateComp"),t.k0s(),t.j41(41,"th",13),t.EFF(42),t.nI1(43,"translateComp"),t.k0s()(),t.DNE(44,gt,2,2,"ng-container",14),t.k0s(),t.DNE(45,V,22,19,"table",15),t.k0s()),2&s&&(t.Y8G("formGroup",o.form),t.R7$(2),t.JRh(t.i5U(3,15,o.msgs.RecipeGenerator,o.lang)),t.R7$(5),t.JRh(t.i5U(8,18,o.msgs.Target,o.lang)),t.R7$(4),t.JRh(t.i5U(12,21,o.msgs.Race,o.lang)),t.R7$(3),t.JRh(t.i5U(15,24,o.msgs.Name,o.lang)),t.R7$(5),t.Y8G("ngForOf",o.races),t.R7$(3),t.Y8G("ngForOf",o.demons[o.form.controls.race.value]),t.R7$(4),t.JRh(t.i5U(27,27,o.msgs.IncludeIngredients,o.lang)),t.R7$(4),t.JRh(t.i5U(31,30,o.msgs.FilterBy,o.lang)),t.R7$(3),t.JRh(t.i5U(34,33,o.msgs.Elem,o.lang)),t.R7$(3),t.JRh(t.i5U(37,36,o.msgs.Skill,o.lang)),t.R7$(3),t.JRh(t.i5U(40,39,o.msgs.Race,o.lang)),t.R7$(3),t.JRh(t.i5U(43,42,o.msgs.Ingredient,o.lang)),t.R7$(2),t.Y8G("ngForOf",o.form.controls.ingreds.controls),t.R7$(1),t.Y8G("ngIf",o.recipe))},dependencies:[F.Sq,F.bT,S.qT,S.xH,S.y7,S.Zm,S.wz,S.BC,S.cb,S.j4,S.JD,S.$R,S.v8,r.uz],styles:["ul[_ngcontent-%COMP%]{padding:0 1em;list-style:none}td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{min-height:25px;width:100%}"],changeDetection:0})}}return l})()},6122:(Z,Y,_)=>{_.d(Y,{L:()=>F});var r=_(3885),e=_(9108),i=_(1090),a=_(2598),k=_(177),I=_(8935),N=_(4207);const P=function(){return{exact:!0}};function B(f,h){if(1&f&&(a.j41(0,"th",4)(1,"a",5),a.EFF(2),a.nI1(3,"translateComp"),a.k0s()()),2&f){const d=h.$implicit,c=a.XpG();a.xc7("width",100/c.fusionOptions.length,"%"),a.Y8G("routerLink",d.link)("routerLinkActiveOptions",a.lJ4(9,P)),a.R7$(1),a.Y8G("routerLink",d.link),a.R7$(1),a.JRh(a.i5U(3,6,d.title,c.lang))}}function W(f,h){if(1&f&&(a.j41(0,"tr")(1,"th",6),a.EFF(2),a.nI1(3,"translateComp"),a.k0s()()),2&f){const d=a.XpG();a.R7$(1),a.BMQ("colspan",d.fusionOptions.length),a.R7$(1),a.SpI(" ",a.i5U(3,2,d.msgs.DlcExcluded,d.lang)," ")}}function t(f,h){if(1&f&&(a.j41(0,"tr")(1,"th",6),a.SdG(2),a.k0s()()),2&f){const d=a.XpG();a.R7$(1),a.BMQ("colspan",d.fusionOptions.length)}}const S=["*"];let F=(()=>{class f{constructor(){this.hasTripleFusion=!1,this.showFusionAlert=!1,this.excludedDlc=!1,this.lang="en",this.msgs=i.Lq,this.fusionOptions=[{title:this.msgs.NormalFissions,link:"fissions"},{title:this.msgs.NormalFusions,link:"fusions"}]}ngOnInit(){this.hasTripleFusion&&(this.fusionOptions=[{title:this.msgs.DoubleFissions,link:"fissions"},{title:this.msgs.TripleFissions,link:"fissions/triple"},{title:this.msgs.TripleFusions,link:"fusions/triple"},{title:this.msgs.DoubleFusions,link:"fusions"}])}ngOnChanges(){setTimeout(()=>this.stickyTable.nextEdges())}static{this.\u0275fac=function(c){return new(c||f)}}static{this.\u0275cmp=a.VBU({type:f,selectors:[["app-smt-fusions"]],viewQuery:function(c,b){if(1&c&&a.GBs(e.a,5),2&c){let m;a.mGM(m=a.lsd())&&(b.stickyTable=m.first)}},inputs:{hasTripleFusion:"hasTripleFusion",showFusionAlert:"showFusionAlert",excludedDlc:"excludedDlc",lang:"lang"},features:[a.Jv_([r.P]),a.OA$],ngContentSelectors:S,decls:11,vars:3,consts:[["appPositionSticky","",1,"list-table"],["stickyTable",""],["class","nav","routerLinkActive","active",3,"routerLink","width","routerLinkActiveOptions",4,"ngFor","ngForOf"],[4,"ngIf"],["routerLinkActive","active",1,"nav",3,"routerLink","routerLinkActiveOptions"],[3,"routerLink"],[1,"title"]],template:function(c,b){1&c&&(a.NAR(),a.j41(0,"div")(1,"table",0,1)(3,"thead")(4,"tr"),a.DNE(5,B,4,10,"th",2),a.k0s(),a.DNE(6,W,4,5,"tr",3),a.nrm(7,"tr"),a.DNE(8,t,3,1,"tr",3),a.nrm(9,"tr"),a.k0s()(),a.nrm(10,"router-outlet"),a.k0s()),2&c&&(a.R7$(5),a.Y8G("ngForOf",b.fusionOptions),a.R7$(1),a.Y8G("ngIf",b.excludedDlc),a.R7$(2),a.Y8G("ngIf",b.showFusionAlert))},dependencies:[k.Sq,k.bT,I.n3,I.Wk,I.wQ,e.a,N.uz],encapsulation:2,changeDetection:0})}}return f})()},6567:(Z,Y,_)=>{_.d(Y,{I:()=>e});var r=_(2598);let e=(()=>{class i{constructor(k,I){this.changeDetector2=k,this.fusionDataService2=I,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.fusionDataService2.compendium.subscribe(k=>{this.changeDetector2.markForCheck(),this.compendium=k})),this.subscriptions.push(this.fusionDataService2.fusionSettings.subscribe(k=>{this.fusionSettings=k}))}ngOnDestroy(){for(const k of this.subscriptions)k.unsubscribe()}toggleAll(k){const I={};for(const N of this.fusionSettings.displayHeaders)for(const P of N.settings)I[P.name]=k;this.fusionDataService2.updateFusionSettings(I)}toggleName(k){const I={};I[k]=!this.fusionSettings.isEnabled(k),this.fusionDataService2.updateFusionSettings(I)}static{this.\u0275fac=function(I){r.QTQ()}}static{this.\u0275dir=r.FsC({type:i})}}return i})()},1939:(Z,Y,_)=>{_.d(Y,{U:()=>r});class r{constructor(i,a,k=","){this.separator=k,this._displayHeaders=[],this._demonToggles={},this._subappToggles={};for(const{category:N,unlocked:P,conditions:B}of i){const W=[];this._displayHeaders.push({category:N,settings:W});for(const t of Object.keys(B))this._demonToggles[t]=P,W.push({name:t,caption:t.split(k).join(", "),enabled:P})}const I=[];a.length>0&&this._displayHeaders.push({category:"Subapps",settings:I});for(const N of a)this._subappToggles[N]=!1,I.push({name:N,caption:N,enabled:!1})}get displayHeaders(){for(const i of this._displayHeaders)for(const a of i.settings)a.enabled=this.saveFile[a.name];return this._displayHeaders}get subappToggles(){return this._subappToggles}get demonToggles(){const i={};for(const[a,k]of Object.entries(this._demonToggles))for(const I of a.split(this.separator))i[I]=k;return i}get saveFile(){return Object.assign({},this._demonToggles,this._subappToggles)}isEnabled(i){return this._demonToggles[i]||this._subappToggles[i]||!1}updateSaveFile(i){for(const a of[this._demonToggles,this._subappToggles])for(const[k,I]of Object.entries(i))a[k]===!I&&(a[k]=I)}}}}]);